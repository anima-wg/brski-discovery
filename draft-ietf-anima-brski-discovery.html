<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Discovery for BRSKI variations</title>
<meta content="Toerless Eckert" name="author">
<meta content="Esko Dijk" name="author">
<meta content="
       This document specifies how BRSKI entities, such as registrars, proxies, pledges or others
that are acting as responders, can be discovered and selected by BRSKI entities acting as initiators. 
    " name="description">
<meta content="xml2rfc 3.20.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-anima-brski-discovery-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.20.1
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.3
    lxml 4.9.4
    platformdirs 4.2.0
    pycountry 23.12.11
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 69.5.1
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-anima-brski-discovery.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BRSKI-discovery</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Eckert &amp; Dijk</td>
<td class="center">Expires 9 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ANIMA</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-anima-brski-discovery-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-08" class="published">8 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-09">9 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Eckert, <span class="editor">Ed.</span>
</div>
<div class="org">Futurewei</div>
</div>
<div class="author">
      <div class="author-name">E. Dijk</div>
<div class="org">IoTconsultancy.nl</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Discovery for BRSKI variations</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies how BRSKI entities, such as registrars, proxies, pledges or others
that are acting as responders, can be discovered and selected by BRSKI entities acting as initiators.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-specification" class="internal xref">Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-abstracted-brski-discovery-" class="internal xref">Abstracted BRSKI discovery and selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-variation-contexts" class="internal xref">Variation Contexts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-variation-types-and-choices" class="internal xref">Variation Types and Choices</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-variations" class="internal xref">Variations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-brski-variations-discovery-" class="internal xref">BRSKI Variations Discovery Registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-brski-variation-contexts-ta" class="internal xref">BRSKI Variation Contexts table</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-brski-variation-type-choice" class="internal xref">BRSKI Variation Type Choices table</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-brski-discoverable-variatio" class="internal xref">BRSKI Discoverable Variations table</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-extending-or-modifying-the-" class="internal xref">Extending or modifying the registry</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-brski-join-proxies-support-" class="internal xref">BRSKI Join Proxies support for Variations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-permissible-variations" class="internal xref">Permissible Variations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-join-proxy-support-for-vari" class="internal xref">Join Proxy support for Variations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-co-location-of-proxy-and-re" class="internal xref">Co-location of Proxy and Registrar</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-brski-pledges-support-for-v" class="internal xref">BRSKI Pledges support for Variations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-brski-pledge-context" class="internal xref">BRSKI-PLEDGE context</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-variation-signaling-and-enc" class="internal xref">Variation signaling and encoding rules for different discovery mechanisms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.1">
                    <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="auto internal xref">3.8.1</a>.  <a href="#name-dns-sd" class="internal xref">DNS-SD</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.2">
                    <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="auto internal xref">3.8.2</a>.  <a href="#name-grasp" class="internal xref">GRASP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.3">
                    <p id="section-toc.1-1.3.2.8.2.3.1"><a href="#section-3.8.3" class="auto internal xref">3.8.3</a>.  <a href="#name-core-lf" class="internal xref">CORE-LF</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-updates-to-existing-rfcs" class="internal xref">Updates to existing RFCs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-rfc8995" class="internal xref">RFC8995</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-brski-variations-discovery-r" class="internal xref">BRSKI Variations Discovery Registry (section)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-service-names-registry" class="internal xref">Service Names Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-brski-well-known-uris-fixes" class="internal xref">BRSKI Well-Known URIs fixes (opportunistic)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-draft-considerations" class="internal xref">Draft considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-open-issues" class="internal xref">Open Issues</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-change-log" class="internal xref">Change log</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-discovery-for-constrained-b" class="internal xref">Discovery for constrained BRSKI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-current-constrained-text-fo" class="internal xref">Current constrained text for GRASP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-issues-and-proposed-change" class="internal xref">Issues and proposed change</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-possible-future-variations" class="internal xref">Possible future variations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="terminology">
<section id="section-1">
      <h2 id="name-terminology">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document relies on the terminology defined in <a href="#BRSKI" class="auto internal xref">Section 1</a>.  The following terms are described partly in addition.<a href="#section-1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-3">
        <dt id="section-1-3.1">Context:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.2">
          <p id="section-1-3.2.1">See Variation Context.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.3">Initiator:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.4">
          <p id="section-1-3.4.1">A host that is using an IP transport protocol to initiate a connection or transaction to another host called the responder.<a href="#section-1-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.5">Initiator socket:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.6">
          <p id="section-1-3.6.1">A socket consisting of an initiators IP or IPv6 address, protocol and protocol port number from which it
initiates connections or transactions to a responder (typically UDP or TCP).<a href="#section-1-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.7">Objective Name:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.8">
          <p id="section-1-3.8.1">See Service Name.<a href="#section-1-3.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.9">Resource Type:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.10">
          <p id="section-1-3.10.1">See Service Name.<a href="#section-1-3.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.11">Responder:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.12">
          <p id="section-1-3.12.1">A host that is using an IP transport protocol to respond to transaction or connection requests from an Initiator.<a href="#section-1-3.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.13">Responder socket:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.14">
          <p id="section-1-3.14.1">A socket consisting of a responders IP or IPv6 address, protocol and protocol port
number on which it responds to requests of the protocol (typically UDP or TCP).<a href="#section-1-3.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.15">Role:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.16">
          <p id="section-1-3.16.1">In the context of this document, a type of entity in a variation of BRSKI that can act as a responder and whose supported variations can be discovered. BRSKI roles relevant in this document include Join Registrar, Join Proxy and Pledge. The IANA registry defined by this document allows to specify variations for any roles. See also Variation Context.<a href="#section-1-3.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.17">Socket:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.18">
          <p id="section-1-3.18.1">The combination of am  IP or IPv6 address, an IP protocol that utilizes a port number (such as TCP or UDP) and a port number of that protocol.<a href="#section-1-3.18.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.19">Service Name:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.20">
          <p id="section-1-3.20.1">The name for (a subset of) the functionality/API provided by a discoverable responder socket. This term is inherited from <a href="#DNS-SD" class="auto internal xref">Section 1</a> but unless otherwise specified also used in this document to apply to any other discovery functionality/API. The terminology used by other mechanisms typically differs. For example, when <a href="#GRASP" class="auto internal xref">Section 1</a> is used to discover a responder socket for BRSKI, the Objective Name carries the equivalent to the service name. In <a href="#CORE-LF" class="auto internal xref">Section 1</a>, the Resource Type (rt=) carries the equivalent of the service name.<a href="#section-1-3.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.21">Type:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.22">
          <p id="section-1-3.22.1">See Variation Type.<a href="#section-1-3.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.23">Variation:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.24">
          <p id="section-1-3.24.1">A combination one one variation choice each for every variation type applicable to the variation context of one discoverable BRSKI communications.
For example, in the context of BRSKI, a variation is one choice for "mode", one choice for "enroll" and once choice for "vformat".<a href="#section-1-3.24.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.25">Variation Context:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.26">
          <p id="section-1-3.26.1">A set of Services for whom the same set of variations applies<a href="#section-1-3.26.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.27">Variation Type:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.28">
          <p id="section-1-3.28.1">The name for one aspect of a protocol for which two or more choices exist (or may exist in the future), and where the choice
can technically be combined orthogonal to other variation types. This document defined the BRSKI variation types "mode", "enroll" and "vformat".<a href="#section-1-3.28.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.29">Variation Type Choice:</dt>
        <dd style="margin-left: 1.5em" id="section-1-3.30">
          <p id="section-1-3.30.1">The name for different values that a particular variation type may have.
For example, this document does defines the choices "rrm" and "prm" for the BRSKI variation "mode".<a href="#section-1-3.30.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.31">
<div id="ACP">ACP:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.32">
          <p id="section-1-3.32.1">"An Autonomic Control Plane", <span>[<a href="#RFC8994" class="cite xref">RFC8994</a>]</span>.<a href="#section-1-3.32.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.33">
<div id="BRSKI">BRSKI:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.34">
          <p id="section-1-3.34.1">"Bootstrapping Remote Secure Key Infrastructure", <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>.<a href="#section-1-3.34.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.35">
<div id="BRSKI-AE">BRSKI-AE:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.36">
          <p id="section-1-3.36.1">"Alternative Enrollment Protocols in <a href="#BRSKI" class="auto internal xref">Section 1</a>", <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>.<a href="#section-1-3.36.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.37">
<div id="BRSKI-PRM">BRSKI-PRM:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.38">
          <p id="section-1-3.38.1">"<a href="#BRSKI" class="auto internal xref">Section 1</a> with Pledge in Responder Mode", <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span>.<a href="#section-1-3.38.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.39">
<div id="cBRSKI">cBRSKI:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.40">
          <p id="section-1-3.40.1">"Constrained Bootstrapping Remote Secure Key Infrastructure (<a href="#BRSKI" class="auto internal xref">Section 1</a>)", <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>.<a href="#section-1-3.40.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.41">
<div id="COAP">COAP:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.42">
          <p id="section-1-3.42.1">"The Constrained Application Protocol (CoAP)", <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-1-3.42.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.43">
<div id="CORE-LF">CORE-LF:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.44">
          <p id="section-1-3.44.1">"Constrained RESTful Environments (CoRE) Link Format", <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>.<a href="#section-1-3.44.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.45">
<div id="cPROXY">cPROXY:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.46">
          <p id="section-1-3.46.1">"Constrained Join Proxy for Bootstrapping Protocols", <span>[<a href="#I-D.ietf-anima-constrained-join-proxy" class="cite xref">I-D.ietf-anima-constrained-join-proxy</a>]</span>.<a href="#section-1-3.46.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.47">
<div id="DNS-SD">DNS-SD:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.48">
          <p id="section-1-3.48.1">"DNS-Based Service Discovery", <span>[<a href="#RFC6763" class="cite xref">RFC6763</a>]</span>.<a href="#section-1-3.48.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.49">
<div id="EST">EST:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.50">
          <p id="section-1-3.50.1">"Enrollment over Secure Transport", <span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>.<a href="#section-1-3.50.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.51">
<div id="GRASP">GRASP:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.52">
          <p id="section-1-3.52.1">"GeneRic Autonomic Signaling Protocol", <span>[<a href="#RFC8990" class="cite xref">RFC8990</a>]</span>.<a href="#section-1-3.52.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.53">
<div id="GRASP-DNSSD">GRASP-DNSSD:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.54">
          <p id="section-1-3.54.1">"DNS-SD Compatible Service Discovery in GeneRic Autonomic Signaling Protocol (GRASP)", <span>[<a href="#I-D.eckert-anima-grasp-dnssd" class="cite xref">I-D.eckert-anima-grasp-dnssd</a>]</span>.<a href="#section-1-3.54.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.55">
<div id="JWS-VOUCHER">JWS-VOUCHER:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.56">
          <p id="section-1-3.56.1">"JWS signed Voucher Artifacts for Bootstrapping Protocols", <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>.<a href="#section-1-3.56.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.57">
<div id="lwCMP">lwCMP:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.58">
          <p id="section-1-3.58.1">"Lightweight Certificate Management Protocol (CMP) Profile", <span>[<a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="cite xref">I-D.ietf-lamps-lightweight-cmp-profile</a>]</span>.<a href="#section-1-3.58.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.59">
<div id="mDNS">mDNS:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.60">
          <p id="section-1-3.60.1">"multicast DNS", <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>.<a href="#section-1-3.60.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-3.61">
<div id="SCEP">SCEP:</div>
        </dt>
<dd style="margin-left: 1.5em" id="section-1-3.62">
          <p id="section-1-3.62.1">"Simple Certificate Enrolment Protocol", <span>[<a href="#RFC8894" class="cite xref">RFC8894</a>]</span>.<a href="#section-1-3.62.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">The mechanisms described in this document are intended to help solve the following challenges.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Signaling BRSKI variation for responder selection.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">When an initiator such as a proxy or pledge uses a mechanism such as
<a href="#DNS-SD" class="auto internal xref">Section 1</a> to discover an instance of a role it intends to connect to, such
as a registrar, it may discover more than one such instance. In the presence
of variations of the BRSKI mechanisms that impact interoperability, performance
or security, not all discovered instances may support exactly what the initiator needs to achieve
interoperability and/or best performance, security or other metrics. In this case, the service
announcement mechanism needs to carry the necessary additional information beside the name that
indicates the service to aid the initiator in
selecting an instance that it can inter operate and achieve best performance with.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Easier use of additional discovery mechanisms.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">In the presence of different discovery mechanisms, such as <a href="#DNS-SD" class="auto internal xref">Section 1</a>, <a href="#GRASP" class="auto internal xref">Section 1</a>,
<a href="#CORE-LF" class="auto internal xref">Section 1</a> or others, the details of how to apply each of these mechanisms are usually
specified individually for each mechanism, easily resulting in inconsistencies. Deriving
as much as possible the details of discovery from a common specification and registries
can reduce such inconsistencies and easy introduction of additional discovery mechanisms.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">Generalization of principles related to discovery and operation of proxies.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Because of the unified approach to discovery of BRSKI Variations described in this document,
it also allows to use <a href="#DNS-SD" class="auto internal xref">Section 1</a> for document for <a href="#cBRSKI" class="auto internal xref">Section 1</a> and <a href="#cPROXY" class="auto internal xref">Section 1</a>, which may be
of interest in networks such as Thread, which use <a href="#DNS-SD" class="auto internal xref">Section 1</a>.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="specification">
<section id="section-3">
      <h2 id="name-specification">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-specification" class="section-name selfRef">Specification</a>
      </h2>
<div id="abstracted-brski-discovery-and-selection">
<section id="section-3.1">
        <h3 id="name-abstracted-brski-discovery-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-abstracted-brski-discovery-" class="section-name selfRef">Abstracted BRSKI discovery and selection</a>
        </h3>
<p id="section-3.1-1">In the abstract model of discovery used by this document and intended to apply to all described discovery mechanisms, an entity operating as an initiator of a transport
connection for a particular BRSKI protocol role, such as a pledge, discovers one or more responder sockets
(IP/IPv6-address, responder-port, IP-protocol) of entities acting as responders for the peer BRSKI role, such
as registrar. The initiator uses some discovery mechanism such as <a href="#DNS-SD" class="auto internal xref">Section 1</a>, <a href="#GRASP" class="auto internal xref">Section 1</a> or <a href="#CORE-LF" class="auto internal xref">Section 1</a>. In the
the initiator looks for a particular combination of a Service Name and an IP-protocol, and in return learns
about responder sockets from one or more responders that use this IP-protocol and serve the requested Service Name
type service across it. It also learns the BRSKI variation(s) supported on the socket.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Service Name is the name of the protocol element used in <a href="#DNS-SD" class="auto internal xref">Section 1</a>, unless explicitly specified, it is used
as a placeholder for the equivalent protocol elements in other discovery mechanisms. In <a href="#GRASP" class="auto internal xref">Section 1</a>, it is called
objective-name, in <a href="#CORE-LF" class="auto internal xref">Section 1</a> it is called Resource Type.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Upon discovery of the available sockets, the initiator selects one, whose supported variation(s) best match
the expectations of the initiator, including performance, security or other preferences. Selection may also
include attempting to establish a connection to the responder socket, and upon connection failure
to attempt connecting to the next best responder socket. This is for example necessary when discovery
information may not be updated in real-time, and the best responder has gone offline.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="variation-contexts">
<section id="section-3.2">
        <h3 id="name-variation-contexts">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-variation-contexts" class="section-name selfRef">Variation Contexts</a>
        </h3>
<p id="section-3.2-1">A Variation Context is a set of (Discover Mechanism, Service Names, IP-protocols) across which this document
and the registry of variations defines a common set of variations. The initial registry defined in this
document defines two variation contexts.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1">BRSKI context:</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">context for discovery of BRSKI registrar and proxy variations by proxies, pledges or agents
(as defined in <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>) via the Service Names defined for <a href="#DNS-SD" class="auto internal xref">Section 1</a> and <a href="#GRASP" class="auto internal xref">Section 1</a> via
TCP and hence (by default) TLS (version 1.2 or higher according to <a href="#BRSKI" class="auto internal xref">Section 1</a>).<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-2.3">cBRSKI context (constrained BRSKI):</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">context for discovery of BRSKI registrar and proxy variations by proxies, pledges
via the Service Names defined for <a href="#DNS-SD" class="auto internal xref">Section 1</a>, <a href="#GRASP" class="auto internal xref">Section 1</a> and <a href="#CORE-LF" class="auto internal xref">Section 1</a> via UDP, and hence (by default) secure COAP.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-3">Note that the Service Names for cBRSKI include the same <a href="#DNS-SD" class="auto internal xref">Section 1</a> Service Names as for the BRSKI context,
hence enabling the use of <a href="#DNS-SD" class="auto internal xref">Section 1</a> with cBRSKI.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">This document does not define variations for different end-to-end encryption mechanisms, so
only the "(by default)" options exist at the time of writing this document. However, the mechanisms described here
can also be used to introduce backward incompatible new secure transport options. For example when responders start
to support only TLS 1.3 or higher in the presence of TLS 1.2 only initiators, then new variations can be added,
such that those initiators will not select those responders.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">This document does not introduce variation contexts for discovery of other BRSKI roles, such as discovery
of pledges by agents (as defined in <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>), or discovery of MASA by registrars. However, the registry
introduced by this document is defined such that it can be extended by such additional contexts through future
documents.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="variation-types-and-choices">
<section id="section-3.3">
        <h3 id="name-variation-types-and-choices">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-variation-types-and-choices" class="section-name selfRef">Variation Types and Choices</a>
        </h3>
<p id="section-3.3-1">A Variation Type is a variation in one aspect of the BRSKI connection between initiator and responder that ideally
orthogonal from variations in other aspects of the BRSKI connection.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">A Variation Type Choice is one alternative (aka: value) for its Variation Type.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">This document, and the initial registry documenting the variation types introduces three variation types as follows:<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-4">
          <dt id="section-3.3-4.1">mode:</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.2">
            <p id="section-3.3-4.2.1">A variation in the basic sequence of URI endpoints communicated. This document introduces the choices of
"rrm" to indicate the endpoints and sequence as defined in <a href="#BRSKI" class="auto internal xref">Section 1</a> and "prm" to indicate the endpoints and sequence
as defined in <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>. Note that registrars also act as responders in "prm". "rrm" was chosen because the
more logical "pim" (pledge initiator mode) term was feared to cause confusion with other technologies that use that term.<a href="#section-3.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.3">vformat (voucher format):</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.4">
            <p id="section-3.3-4.4.1">A variation in the encoding format of the voucher communicated between registrar and pledge. This document introduces
the choices "cms" as defined in <a href="#BRSKI" class="auto internal xref">Section 1</a>, "cose" as defined in <a href="#cBRSKI" class="auto internal xref">Section 1</a> and "jose" as defined in <a href="#JWS-VOUCHER" class="auto internal xref">Section 1</a>.<a href="#section-3.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-4.5">enroll:</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-4.6">
            <p id="section-3.3-4.6.1">A variation in the URI endpoints used for enrollment of the pledge with keying material (trust anchors and certificate (chain)). This document introduces the following :choices<a href="#section-3.3-4.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-4.6.2.1">
                <p id="section-3.3-4.6.2.1.1">"est" as introduced by <a href="#BRSKI" class="auto internal xref">Section 1</a> to indicate the <a href="#EST" class="auto internal xref">Section 1</a> protocol, which is default<a href="#section-3.3-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3-4.6.2.2">
                <p id="section-3.3-4.6.2.2.1">"cmp" to indicate the CMP protocol according to the Lightweight CMP profile (<a href="#lwCMP" class="auto internal xref">Section 1</a>). The respective adaptations to BRSKI have been introduced by <a href="#BRSKI-AE" class="auto internal xref">Section 1</a>.<a href="#section-3.3-4.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.3-4.6.2.3">
                <p id="section-3.3-4.6.2.3.1">"scep" to indicate <a href="#SCEP" class="auto internal xref">Section 1</a>. This is only a reservation, because no specification for the use of <a href="#SCEP" class="auto internal xref">Section 1</a> with BRSKI exists.<a href="#section-3.3-4.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="variations">
<section id="section-3.4">
        <h3 id="name-variations">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-variations" class="section-name selfRef">Variations</a>
        </h3>
<p id="section-3.4-1">A Variation is the combination of one Choice each for every Variation Type applicable to the Variation Context.
In other words, a variation is a possible instance of BRSKI if supported by initiator and responder. In <a href="#BRSKI" class="auto internal xref">Section 1</a>,
the default variation is "registrar responder mode" (rrm) and use of the "cms voucher format" (cms).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="brski-variations-discovery-registry">
<section id="section-3.5">
        <h3 id="name-brski-variations-discovery-">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-brski-variations-discovery-" class="section-name selfRef">BRSKI Variations Discovery Registry</a>
        </h3>
<p id="section-3.5-1">The IANA "BRSKI Variations Registry" as specified by this document, see <a href="#registry" class="auto internal xref">Section 5.1</a> specifies the
defined parameters for discovery of BRSKI variations.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div id="brski-variation-contexts-table">
<section id="section-3.5.1">
          <h4 id="name-brski-variation-contexts-ta">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-brski-variation-contexts-ta" class="section-name selfRef">BRSKI Variation Contexts table</a>
          </h4>
<p id="section-3.5.1-1">This table, <a href="#fig-contexts" class="auto internal xref">Table 1</a>, defines the BRSKI Variations Contexts.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">The "Applicable Variation Types" lists the Variation Types from whose choices a Variation for this
context is formed. The "Service Name(s)" column lists the discovery mechanisms and their Service Name(s)
that constitute the context.<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="brski-variation-type-choices-table">
<section id="section-3.5.2">
          <h4 id="name-brski-variation-type-choice">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-brski-variation-type-choice" class="section-name selfRef">BRSKI Variation Type Choices table</a>
          </h4>
<p id="section-3.5.2-1">This table, <a href="#fig-choices" class="auto internal xref">Table 2</a>, defines the Variations Type Choices.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">The "Context" column lists the BRSKI Variation Context(s) to which this line applies. If it is empty, then the same
Context(s) apply as that of the last prior line with a non-empty Context column.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-3">The "Variation Type" column lists the BRSKI Variation Type to which this line applies. If it is empty, then the
same Variation Type applies as that of the last prior line with a non-empty Variation Type column.
Variation Types <span class="bcp14">MUST</span> the listed in the order in which the Variation Types are listed in the Applicable Variation Types
column of the BRSKI Variation Contexts table.<a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
<p id="section-3.5.2-4">The "Variation Type Choice" column defines a Variation Type Choice term within the Context(s) of the line.
To allow the most flexible encodings of variations, all Variation Types and Variation Type Choices <span class="bcp14">MUST</span> be unique strings (across all Variation Types).
This allows to encode Variation Type Choices in a discovery mechanism without indicating their Variation Type. Variation Types
and Variation Type Choices and <span class="bcp14">MUST</span> be strings from lowercase letters a-z and digits 0-9 and <span class="bcp14">MUST</span> start with a letter. The
maximum length of a Variation Type Choice is 12 characters.<a href="#section-3.5.2-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2-5">The "Reference" column specifies the documents which describe the Variation Type Choice. Relevant specification
includes those that only specify the semantics without referring to the aspects of discovery and/or those
that specify only the Discovery aspects. Current RFCs for BRSKI variations preceding this RFC typically
only specify the semantics, and this document adds the discovery aspects.<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
<p id="section-3.5.2-6">The "Dflt" Flag specifies a Variation Type Choice that is assumed to be the default Choice for the Context,
such as "rrm" for the BRSKI context. Such a Variation Type Choice is to be assumed to be supported in discovery
if discovery is performed without indication of any or an empty signaling element to carry the Variation or
Variation Choices. For example, <a href="#BRSKI" class="auto internal xref">Section 1</a> specifies the empty string "" as the objective-value in <a href="#GRASP" class="auto internal xref">Section 1</a>
discovery. Because "rrm", "est" and "cms" are default in the BRSKI context, this Discovery signaling
indicates the support for those Variation Type Choices.<a href="#section-3.5.2-6" class="pilcrow">¶</a></p>
<p id="section-3.5.2-7">The "Dflt<em>" Flag specifies a Variation Type Choice that is only default in a subset of Discovery options in a
context. The Note(s) column has then to explain which subset this is. Like for "Dflt", the signaling in
this subset of Discovery options can then forego indication of the "Dflt</em>" Variation Type Choice.<a href="#section-3.5.2-7" class="pilcrow">¶</a></p>
<p id="section-3.5.2-8">The "Rsvd" Flag specifies a Variation Type Choice for which no complete specification exist on how to use it
within BRSKI (or more specifically the context), but which is known to be of potential interest. "Rsvd"
Variation Type Choices <span class="bcp14">MUST NOT</span> be considered for the  Discoverable Variations table. They are documented
primarily to reserve the Variation Type Choice term.<a href="#section-3.5.2-8" class="pilcrow">¶</a></p>
<p id="section-3.5.2-9">The Note(s) section expands the Variation Type Choice terms and provides additional beneficial specification
references beyond the "Reference" column.<a href="#section-3.5.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="variation">
<section id="section-3.5.3">
          <h4 id="name-brski-discoverable-variatio">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-brski-discoverable-variatio" class="section-name selfRef">BRSKI Discoverable Variations table</a>
          </h4>
<p id="section-3.5.3-1">This table <a href="#fig-variations" class="auto internal xref">Table 3</a> enumerates the Discoverable Variations and categorizes them.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">The "Context" column lists the BRSKI Variation Context(s) to which this line applies. If it is empty, then the same
Context(s) apply as that of the last prior line with a non-empty Context column.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
<p id="section-3.5.3-3">The "Spec / Applicability" lists the document(s) that specify the variation, if the variation is
explicitly described. If the variation is not described explicitly, but rather a combination of
Variation Type Choices from more than one BRSKI related specification, then this column will
indicate "-" if by expert opinion it is assumed that this variation should work, or "NA", if
by expert opinion, this variation could not work. The "Explanations" column includes references
to the relevant documents and as necessary additional explanation.<a href="#section-3.5.3-3" class="pilcrow">¶</a></p>
<p id="section-3.5.3-4">The "Variation" column lists the Variation Type Choices that form the Variation. The Variation Type Choices
<span class="bcp14">MUST</span> be listed in the order in which the Variation Types are listed in the Applicable Variation Types
column of the BRSKI Variation Contexts table.<a href="#section-3.5.3-4" class="pilcrow">¶</a></p>
<p id="section-3.5.3-5">The "Variation String" column has the string term used to indicate the variation when using the
simple encoding of BRSKI Variation Discovery for GRASP as described in <a href="#GRASP" class="auto internal xref">Section 1</a>. It is formed by
concatenating the Choices term from the Variation column with the "-" character, excluding those
Choices terms (and "-" concatenator) which are Default for the Context. If this procedure ends
up with the empty string, then this is indicated as "" in the column.<a href="#section-3.5.3-5" class="pilcrow">¶</a></p>
<p id="section-3.5.3-6">The "Explanations" column explains the "Spec / Applicability" status of the Variation.<a href="#section-3.5.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extending-or-modifying-the-registry">
<section id="section-3.5.4">
          <h4 id="name-extending-or-modifying-the-">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-extending-or-modifying-the-" class="section-name selfRef">Extending or modifying the registry</a>
          </h4>
<p id="section-3.5.4-1">Unless otherwise specified below, extension or changes to the registry require standards action.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.5.4-2">Additional Variation Type Choices and Variation Context discovery mechanism Service Names including
additional discovery mechanisms require (only) specification and expert review if they refer to non standard action
protocols and/or protocol variation aspects. For example, a specification how to use <a href="#SCEP" class="auto internal xref">Section 1</a> with BRSKI would
fall under this clause as it is an informational RFC.<a href="#section-3.5.4-2" class="pilcrow">¶</a></p>
<p id="section-3.5.4-3">Non standards action Variation Type Choices can not be Default(Dflt). They can only be Dflt* for non standards action
(sub)Contexts.<a href="#section-3.5.4-3" class="pilcrow">¶</a></p>
<p id="section-3.5.4-4">Reservation of additional Variation Type Choices requires (only) expert review.<a href="#section-3.5.4-4" class="pilcrow">¶</a></p>
<p id="section-3.5.4-5">Additional Contexts <span class="bcp14">MUST</span> be added at the end of the BRSKI Variation Contexts table.<a href="#section-3.5.4-5" class="pilcrow">¶</a></p>
<p id="section-3.5.4-6">Additional Variation Types <span class="bcp14">MUST</span> be added at the end of the Applicable Variation Types column of the
BRSKI Variation Contexts table and at the end of existing lines for the Context in the
BRSKI Variation Type Choices. Additional Variation Types <span class="bcp14">MUST</span> be introduced with a Default (Dflt)
Variation Type Choice. These rules ensures that the rule to create the Variation String for GRASP
(and as desired by other discovery mechanism), and it also enables to add new Variation Type and Choices
without changing pre-existing Variation Strings: Any Variations String implicitly include the Default Choice for
any future Variation Types.<a href="#section-3.5.4-6" class="pilcrow">¶</a></p>
<p id="section-3.5.4-7">When a new Variation Type is added, their Default Choice <span class="bcp14">SHOULD</span> be added to the Variation Column of existing
applicable lines in the BRSKI Discoverable Variations table. Variations that include new non-Default
Variation Type Choices <span class="bcp14">SHOULD</span> be added at the end of the existing lines for the Context.<a href="#section-3.5.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="brski-join-proxies-support-for-variations">
<section id="section-3.6">
        <h3 id="name-brski-join-proxies-support-">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-brski-join-proxies-support-" class="section-name selfRef">BRSKI Join Proxies support for Variations</a>
        </h3>
<div id="permissible-variations">
<section id="section-3.6.1">
          <h4 id="name-permissible-variations">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-permissible-variations" class="section-name selfRef">Permissible Variations</a>
          </h4>
<p id="section-3.6.1-1">Variations according to the terminology of this document are those that do not require changes to BRSKI join proxy operations,
but that can transparently pass across existing join proxies without changes to them - as long as they support the rules
outlined in this document.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<p id="section-3.6.1-2">Different choices for e.g.: pledge to registrar encryption mechanisms, voucher format (vformat), use of different URI endpoints or enrollment
protocol endpoints (mode) are all transparent to join proxies, and hence join proxies can not only support existing, well-defined
Choices of these Variation Types, but without changes to the proxies also future ones - and only those are permitted to become
Variation Type Choices.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
<p id="section-3.6.1-3">Changes to the BRSKI mechanism that do require additional changes to join proxies are not considered Variations
according to this document and <span class="bcp14">MUST NOT</span> use the same discovery protocol signaling elements as those defined for variations
by this document. Instead, they <span class="bcp14">SHOULD</span> use different combinations of Service Name and Protocol (e.g.: TCP vs. UDP).<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
<p id="section-3.6.1-4">For example, the stateless join proxy mode defined by <a href="#cPROXY" class="auto internal xref">Section 1</a> is such a mechanism that requires explicit
join proxy support. Therefore, registrars sockets that support circuit proxy mode use the GRASP objective "AN_join_registrar",
and registrar sockets that support stateless join proxy mode use the GRASP objective "AN_join_registrar_rjp". This
enables join proxies to select the registrar and socket according to what the join proxy supports and prefers. By
not using the same signaling element(s) for variations, join proxies can support discovery of all variations
independent of their support for stateless join proxy operations.<a href="#section-3.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="proxy">
<section id="section-3.6.2">
          <h4 id="name-join-proxy-support-for-vari">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-join-proxy-support-for-vari" class="section-name selfRef">Join Proxy support for Variations</a>
          </h4>
<p id="section-3.6.2-1">Join proxies supporting the mechanisms of this document <span class="bcp14">MUST</span> signal for each socket they announce to initiators via a discovery
mechanism the Variation(s) supported on the socket. These Variation(s) <span class="bcp14">MUST</span> all be supported by the registrar that the join
proxy then uses for the connection from the initiator (e.g.: pledge). Pledges <span class="bcp14">SHOULD</span> announce sockets to initiators so that
all Variations that are supported by registrars that the join proxy can interoperate with are also available to the initiators
connecting to the join proxy.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">To meet these requirements, join proxies can employ different implementation option. In the most simple one, a join proxy
allocates a separate responder socket for every Variation for which it discovers one or more registrars supporting
this Variation. It then announces that socket with only that one Variation in the discovery mechanism, even if the Registrar(s) are all
announcing their socket with multiple Variations. When the join proxy operates in circuit mode, it can then
select one of the registrars supporting the variation for every new initiator connection based on policies
as specified by BRSKI specifications and/or discovery parameters, such as priority and weight when <a href="#DNS-SD" class="auto internal xref">Section 1</a> is used,
and redundant registrars include those parameters.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
<p id="section-3.6.2-3">TBD: insert example of received Registrar announcement and created proxy announcement ??<a href="#section-3.6.2-3" class="pilcrow">¶</a></p>
<p id="section-3.6.2-4">Join proxies <span class="bcp14">MAY</span> reduce the number of sockets announced to initiators by using a single socket for all Variations for
which they have the same set of registrar sockets supporting those Variations. This primarily helps to reduce the size
of the discovery messages to initiators and can save socket resources on the join proxy.<a href="#section-3.6.2-4" class="pilcrow">¶</a></p>
<p id="section-3.6.2-5">Join proxies <span class="bcp14">MAY</span> create multiple sockets in support of other discovery options, even for the same Variation(s).
For example, if <a href="#DNS-SD" class="auto internal xref">Section 1</a> is used by two registrars, both announcing the same priority but different weights, then
the join proxy may create a separate socket for each of these registrars - and their variations, so that the join proxy can equally announce the same
priority and weight for both sockets to initiators. This allows to maintain the desired weights of use of registrars,
even when the join proxy operates in stateless mode, in which it can not select a separate registrar for every
client initiating a connection.<a href="#section-3.6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="colo">
<section id="section-3.6.3">
          <h4 id="name-co-location-of-proxy-and-re">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-co-location-of-proxy-and-re" class="section-name selfRef">Co-location of Proxy and Registrar</a>
          </h4>
<p id="section-3.6.3-1">In networks using <a href="#BRSKI" class="auto internal xref">Section 1</a> and <a href="#ACP" class="auto internal xref">Section 1</a>, registrars must have a co-located
proxy, because pledges can only use single-hop discovery (DULL-GRASP) and will only discover
proxies, but not registrar. Such a co-located proxy does not constitute additional processing/code
on a registrar supporting circuit mode, it simply implies that the registrars BRSKI services(s) are
announced with a proxy Service Name, to support pledges, and the  registrar service name, to
support join proxies.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">To ease consistency of deployment models in the face of different discovery mechanisms, Variations and
non-Variation enhancements to BRSKI, it is <span class="bcp14">RECOMMENDED</span> that all future options to BRSKI do always have
a Service Name for proxies and a separate Service Name in support of pledge or other initiators. Pledges
and other initiators <span class="bcp14">SHOULD</span> always only look for the proxy Service Name, and only Proxies should look
for a registrar Service Name. Registrars therefore <span class="bcp14">SHOULD</span> always include the proxy functionality according
to the prior paragraph. This only involves additional code on the registrar beyond the service announcement
in case the Registrar would otherwise not implement circuit mode.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="brski-pledges-support-for-variations">
<section id="section-3.7">
        <h3 id="name-brski-pledges-support-for-v">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-brski-pledges-support-for-v" class="section-name selfRef">BRSKI Pledges support for Variations</a>
        </h3>
<div id="brski-pledge-context">
<section id="section-3.7.1">
          <h4 id="name-brski-pledge-context">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-brski-pledge-context" class="section-name selfRef">BRSKI-PLEDGE context</a>
          </h4>
<p id="section-3.7.1-1">BRSKI-PLEDGE is the context for discovery of pledges by nodes such as registrar-agents.
Pledges supporting <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a> <span class="bcp14">MUST</span> support it. It may also be used by other variations of BRSKI
when supported by pledges.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">Pledges supporting BRSKI-PLEDGE <span class="bcp14">MUST</span> support DNS-SD for discovery via mDNS, using link-local scope.
For DNS-SD discovery beyond link-local scope, pledges <span class="bcp14">SHOULD</span> support DNS-SD via <span>[<a href="#I-D.ietf-dnssd-srp" class="cite xref">I-D.ietf-dnssd-srp</a>]</span>.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
<p id="section-3.7.1-3">TBD: Is there sufficient auto-configuration support in <span>[<a href="#I-D.ietf-dnssd-srp" class="cite xref">I-D.ietf-dnssd-srp</a>]</span>, that pledges without any
configuration can use it, and if so, do we need to raise specific additional requirements to enable this
in pledges ?<a href="#section-3.7.1-3" class="pilcrow">¶</a></p>
<p id="section-3.7.1-4">These DNS-SD requirements are defaults. Specifications for specific deployment contexts such as specific
type of radio network solutions may need to specify their own requirements overriding or amending these
requirements.<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
<p id="section-3.7.1-5">Pledges <span class="bcp14">MUST</span> support to be discoverable via their service instance name. They <span class="bcp14">MAY</span> be discoverable
via DNS-SD browsing, so that registrar-agents can find even unexpected pledges through DNS-SD browsing.<a href="#section-3.7.1-5" class="pilcrow">¶</a></p>
<p id="section-3.7.1-6">Support for browsing is required to discover over the network pledges supporting only <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>,
but not <a href="#BRSKI" class="auto internal xref">Section 1</a> if they have no known serial-number information from which their service instance
name can be constructed, so it is a crucial feature for robust enrollment.  See <a href="#security-considerations" class="auto internal xref">Section 6</a>
for more details about discovery and BRSKI-PLEDGE.<a href="#section-3.7.1-6" class="pilcrow">¶</a></p>
<p id="section-3.7.1-7">When pledges are discoverable vis DNS-SD browsing, they <span class="bcp14">MUST</span> expect that a large number of pledges
exist in the network at the same time, such as in the order of 100 or more, and schedule their responses
according to the procedures in <a href="#mDNS" class="auto internal xref">Section 1</a> and <a href="#DNS-SD" class="auto internal xref">Section 1</a> to avoid simultaneous reply from all pledges.<a href="#section-3.7.1-7" class="pilcrow">¶</a></p>
<p id="section-3.7.1-8">TBD: What is the best section in mDNS/DNS-SD to point to for this timed reply to scale ?<a href="#section-3.7.1-8" class="pilcrow">¶</a></p>
<p id="section-3.7.1-9">Browsing via DNS-SD for a pledge is circumvented by the pledge not announcing its PTR RR for
"brski-registrar". Technically, the remaining RR may not constitute full DNS-SD service, but
they do provide the required discovery for the known service instance name of the pledge.<a href="#section-3.7.1-9" class="pilcrow">¶</a></p>
<p id="section-3.7.1-10">counter measures such as limiting the number and rate of PRM connects that they accept, ideally
on a per-initiator basis (assuming that DDoS attacks are more harder to mount than single
attacker DoS attacks).<a href="#section-3.7.1-10" class="pilcrow">¶</a></p>
<div id="service-instance-name">
<section id="section-3.7.1.1">
            <h5 id="name-service-instance-name">
<a href="#section-3.7.1.1" class="section-number selfRef">3.7.1.1. </a><a href="#name-service-instance-name" class="section-name selfRef">Service Instance Name</a>
            </h5>
<p id="section-3.7.1.1-1">The service instance name chosen by a BRSKI pledge <span class="bcp14">MUST</span> be composed from information which is<a href="#section-3.7.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.1.1-2.1">
                <p id="section-3.7.1.1-2.1.1">Easily known by BRSKI operations, such as the operational personnel or software automation,
specifically sales integration,<a href="#section-3.7.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.7.1.1-2.2">
                <p id="section-3.7.1.1-2.2.1">Available to the pledges BRSKI software itself, for example by being encoded in some attribute of the IDevID.<a href="#section-3.7.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.7.1.1-3">Typically, a customer will know the serial number of a product from sales information, or even
from bar-code/QR-codes on the product itself. If this serial number is used as the service instance
name to discover a pledge from a registrar-agent, then this may lead to possible duplicate replies
from two or more pledges having the same serial number, such as in the following cases:<a href="#section-3.7.1.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.7.1.1-4">
<li id="section-3.7.1.1-4.1">
                <p id="section-3.7.1.1-4.1.1">A manufacturer has different product lines and re-uses serial-numbers across them.<a href="#section-3.7.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-3.7.1.1-4.2">
                <p id="section-3.7.1.1-4.2.1">Two different manufacturer re-use the same serial-numbers.<a href="#section-3.7.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-3.7.1.1-5">If pledges enable browsing of their service instance name, they <span class="bcp14">MAY</span> support <a href="#DNS-SD" class="auto internal xref">Section 1</a> specified
procedures to create unique service instance names when they discover such clashes, by appending
a space and serial number, starting with 2 to the service instance name: "&lt;service-instance-name&gt; (2)",
as described in <a href="#DNS-SD" class="auto internal xref">Section 1</a> Appendix D.<a href="#section-3.7.1.1-5" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-6">Nevertheless, this approach to resolving conflicts is not desirable:<a href="#section-3.7.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.1.1-7.1">
                <p id="section-3.7.1.1-7.1.1">If browsing of DNS-SD service instance name is not supported, registrar-agents would have to
always (and mostly wrongly) guess that there is a clash and (mostly unnecessarily) search
for "&lt;service-instance-name&gt; (2)".<a href="#section-3.7.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.7.1.1-7.2">
                <p id="section-3.7.1.1-7.2.1">If a clash exists between pledges from the same manufacturer, and even if the registrar-agent
then attempts to start enrolling all pledges with the same clashing service instance name,
it may not have enough information to determine which the correct pledge is. This would happen
especially if the IDevID from both devices (of different product type), had the same serial
number, and the CA of both was the same (because they come from the same manufacturer).
Even if some other IDevID field was used to distinguish their device model, the registrar-agent
would not be able to determine that difference without additional vendor specific programming.<a href="#section-3.7.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.7.1.1-8">In result:<a href="#section-3.7.1.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.1.1-9.1">
                <p id="section-3.7.1.1-9.1.1">Vendors <span class="bcp14">MUST</span> document a scheme how their pledges form a service instance name from
information available to the customer of the pledge.<a href="#section-3.7.1.1-9.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.7.1.1-9.2">
                <p id="section-3.7.1.1-9.2.1">These service instance names <span class="bcp14">MUST</span> be unique across all IDevID of the manufacturer that
share the same CA.<a href="#section-3.7.1.1-9.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.7.1.1-10">The following mechanisms are recommended:<a href="#section-3.7.1.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.7.1.1-11.1">
                <p id="section-3.7.1.1-11.1.1">Pledges <span class="bcp14">SHOULD</span> encode manufacturer unique product instance information in their
subject name serialNumber. <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> calls this the X520SerialNumber.<a href="#section-3.7.1.1-11.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.7.1.1-11.2">
                <p id="section-3.7.1.1-11.2.1">Pledges <span class="bcp14">SHOULD</span> make this serialNumber information consistent with easily accessible
product instance information when in physical possession of the pledge, such as
product type code and serial number on bar-code/QR-code to enable <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a> discovery
without additional backend sales integration. Note that discovery alone does not
allow for enrollment!<a href="#section-3.7.1.1-11.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.7.1.1-11.3">
                <p id="section-3.7.1.1-11.3.1">Pledges <span class="bcp14">SHOULD</span> construct their service instance name by concatenating
their X520SerialNumber with a domain name prefix that is used by the manufacturer
and thus allows to disambiguate devices from different manufacturer using the
same serialNumber scheme, and hence the likelihood of service instance name clashes.<a href="#section-3.7.1.1-11.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<span id="name-example-service-instance-na"></span><div id="service-name-example">
<figure id="figure-1">
              <div class="alignLeft art-text artwork" id="section-3.7.1.1-12.1">
<pre>
Service Instance Name:
  "PID:Model-0815 SN:WLDPC2117A99.example.com"

Manufacturer published Service Instance Name schema:
 PID:\&lt;PID&gt;\\ SN:\&lt;SN&gt;.example.com

Pledge IDevID certificate information:
  ; Format as shown by e.g.: openssh
  Subject: serialNumber = "PID:Model-0815 SN:WLDPC2117A99",
    O = Example, CN = Model-0815

DNS-SD RR for the pledge:
  ; PTR RR to support browsing / discovery of service instance name
  _brski-pledge._tcp.local  IN PTR
    PID:Model-0815\\ SN:WLDPC2117A99\\.example\\.com._brski-pledge._tcp.local

  ; SRC and TXT RR for the service instance name
  PID:Model-0815\\ SN:WLDPC2117A99\\.example\\.com._brski-pledge._tcp.local
    IN SRV 1 1
    PID:Model-0815\\ SN:WLDPC2117A99\\.example\\.com.local
  PID:Model-0815\\ SN:WLDPC2117A99\\.example\\.com._brski-pledge._tcp.local
    IN TXT ""

  ; AAAA address resolution for the target host name
  PID:Model-0815\\ SN:WLDPC2117A99\\.example\\.com.local
    IN AAAA fda3:79a6:f6ee:0000::0200:0000:6400:00a1
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-service-instance-na" class="selfRef">Example service instance name data</a>
              </figcaption></figure>
</div>
<p id="section-3.7.1.1-13">In <a href="#service-name-example" class="auto internal xref">Figure 1</a>, the manufacturer "example" identifies device instances
through a product identifier &lt;PID&gt; and a serial number &lt;SN&gt;. Both are printed on labels
on the product/packaging and/or communicated during purchase of the product.<a href="#section-3.7.1.1-13" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-14">The service instance name of pledges from this manufacturer are using the
string "PID:&lt;PID&gt; SN:&lt;SN&gt;.example.com". "example.com" is assumed to be a
domain owned by this manufacturer. &lt;PID&gt; and &lt;SN&gt; are replaced by the actual
strings.<a href="#section-3.7.1.1-14" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-15">The IDevID encodes the service instance name without the domain ending (".example.com")
in the X520SerialNumber field. Other fields of the IDevID are not used.<a href="#section-3.7.1.1-15" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-16">The resulting DNS-SD RRs that the pledge announces are shown in the example.
" " and "." characters are escaped as recommended by <a href="#DNS-SD" class="auto internal xref">Section 1</a>.<a href="#section-3.7.1.1-16" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-17">In this example, the same string as constructed for the service instance name
is also used as the target host name. This is of course not necessary, but
unless the pledge already obtains a host name through other DNS means,
re-using the same name allows to avoid coming up with a second method to
construct a unique name.<a href="#section-3.7.1.1-17" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="variation-signaling-and-encoding-rules-for-different-discovery-mechanisms">
<section id="section-3.8">
        <h3 id="name-variation-signaling-and-enc">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-variation-signaling-and-enc" class="section-name selfRef">Variation signaling and encoding rules for different discovery mechanisms</a>
        </h3>
<div id="dns-sd">
<section id="section-3.8.1">
          <h4 id="name-dns-sd">
<a href="#section-3.8.1" class="section-number selfRef">3.8.1. </a><a href="#name-dns-sd" class="section-name selfRef">DNS-SD</a>
          </h4>
<div id="signaling">
<section id="section-3.8.1.1">
            <h5 id="name-signaling">
<a href="#section-3.8.1.1" class="section-number selfRef">3.8.1.1. </a><a href="#name-signaling" class="section-name selfRef">Signaling</a>
            </h5>
<p id="section-3.8.1.1-1">The following definitions apply to any instantiation of DNS-SD including DNS-SD via mDNS as defined in
<a href="#DNS-SD" class="auto internal xref">Section 1</a>, but also via unicast DNS, for example by registering the necessary DNS-SD Resource Records (RR) via <span>[<a href="#I-D.ietf-dnssd-srp" class="cite xref">I-D.ietf-dnssd-srp</a>]</span> (SRP).<a href="#section-3.8.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.8.1.1-2">The requirements in this document do not guarantee interoperability when using DNS-SD, instead, they need to be amended
with deployment specific specifications / requirements as to which signaling variation, such as mDNS
or unicast DNS with SRP is to be supported between initiator and responder. When using unicast DNS
(with SRP), additional mechanisms are required to learn the IP / IPv6 address(es) of feasible DNS and
SRP servers, and deployment may also need agreements for the (default) domain they want to use in
unicast DNS. Hence, a mandatory to implement (MTI) profile is not feasible because of the wide range
of variations to deploy DNS-SD.<a href="#section-3.8.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.8.1.1-3">TBD: We could say that mDNS <span class="bcp14">MUST</span> be supported, unless the network context defines an interoperable
mode to support DNS-SD without mDNS ???<a href="#section-3.8.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding">
<section id="section-3.8.1.2">
            <h5 id="name-encoding">
<a href="#section-3.8.1.2" class="section-number selfRef">3.8.1.2. </a><a href="#name-encoding" class="section-name selfRef">Encoding</a>
            </h5>
<p id="section-3.8.1.2-1">Variation Type Choices defined in the IANA registry <a href="#fig-variations" class="auto internal xref">Table 3</a> are encoded as <a href="#DNS-SD" class="auto internal xref">Section 1</a> Keys with
a value of 1 in the DNS-SD service instances TXT RR.
This is possible because all Variation Type Choices are required to be unique across all Variation Types. It also allows to shorten
the encoding from "key=1" to just "key" for every Variation Type Choice, so that the TXT-DATA encoding can be more compact.<a href="#section-3.8.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-2">If the TXT Record does not contain a Variation Type Choice for a particular applicable Variation Type, then this indicates
support for the Default Choice of this Variation Type in the context of the DNS-SD Service Name. For example, if the TXT
Record is "jose", then this indicates support for "rrm" and "est", if the Service Name is brski-registrar or brski-proxy and the
protocol is TCP (BRSKI Context), but also when the protocol is UDP (cBRSKI context), because "rrm" and "est" are defaults
in both contexts.<a href="#section-3.8.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-3">If multiple Variation Type Choices for the same Variation Type are indicated, then this implies
that either of these Variation Type Choices is supported in conjunction with any of the other
Variation Type Choices in the same TXT Record. For example, if the TXT Record is "prm" "rrm" "cms" "jose", then
this implies support for rrm-cms-est, rrm-jose-est, prm-cms-est and prm-jose-est. This example also shows
that if the default Variation Type Choice, such as "rrm" and another Choice of the same Variation Type ("prm") are to
be indicated as supported, then both need to be included in the TXT Record.<a href="#section-3.8.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-4">In <a href="#DNS-SD" class="auto internal xref">Section 1</a>, a responder does not only indicate a Service Name, but also its Service Instance Name, which needs
to be unique across the domain to support initiators selecting a responder. This specification makes no recommendation
for choosing the Instance portion of that name. Usually it is the same, or derived from some form of pre-existing system name.<a href="#section-3.8.1.2-4" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-5">Registrars <span class="bcp14">SHOULD</span> support support their configuration without specifying a name to use in the Service Instance Name to minimize the
amount of configuration required. Registrars <span class="bcp14">SHOULD</span> support the configuration of such a name.<a href="#section-3.8.1.2-5" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-6">If the responder needs to indicate different sockets for different (set of) Variations, for example,
when operating as a proxy, according to <a href="#proxy" class="auto internal xref">Section 3.6.2</a>, then it needs to signal for each socket a separate Service Instance Name
with the appropriate port information in its SRV Record and the supported Variations for that socket in the TXT Record of that
Service Instance Name. In this case, it is <span class="bcp14">RECOMMENDED</span> that the Instance Name includes the Variation it supports,
such as in the format specified in <a href="#variation" class="auto internal xref">Section 3.5.3</a> and used in the Variation String column of the <a href="#fig-variations" class="auto internal xref">Table 3</a> table.<a href="#section-3.8.1.2-6" class="pilcrow">¶</a></p>
<span id="name-dns-sd-for-a-simple-brski-a"></span><div id="dnssd-example-1">
<figure id="figure-2">
              <div class="alignLeft art-text artwork" id="section-3.8.1.2-7.1">
<pre>
               _brski-registrar._tcp.local
               IN PTR  0200:0000:7400._brski-registrar._tcp.local
0200:0000:7400._brski-registrar._tcp.local
                IN SRV  1 2 4555 0200:0000:7400.local
0200:0000:7400._brski-registrar._tcp.local IN TXT  "rrm" "prm"
0200:0000:7400.local
                IN AAAA  fda3:79a6:f6ee:0000::0200:0000:6400:0001

               _brski-registrar._udp.local
                IN PTR  0200:0000:7400._brski-registrar._udp.local
0200:0000:7400._brski-registrar._udp.local
                IN SRV  1 2 5684 0200:0000:7400.local
0200:0000:7400._brski-registrar._udp.local IN TXT  ""
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-dns-sd-for-a-simple-brski-a" class="selfRef">DNS-SD for a simple BRSKI and cBRSKI registrar</a>
              </figcaption></figure>
</div>
<p id="section-3.8.1.2-8">In the above example <a href="#dnssd-example-2" class="auto internal xref">Figure 3</a>, a registrar supports BRSKI with "rrm" and "prm" modes across the same TCP socket, port 4555.
It uses "cms" voucher format and "est" enrollment, which are not included in the TXT strings because both are default for
_brski-registrar._tcp. The registrar also offers cBRSKI with "rrm" mode,  "cose" voucher and "est" enrollment on UDP port 5684,
the COAP over DTLS default port. The TXT RR for this has only an empty string because "rrm", "cose" and
"est" are default for cBRSKI.<a href="#section-3.8.1.2-8" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-9">As the instance name, the registrar uses in this example the MAC address "0200:0000:7400", which is
MAC address of the interface on which the registrar has the IPv6 address "fda3:79a6:f6ee:0000::0200:0000:6400:0001".
The registrar should know that this MAC address is globally unique (assigned by IEEE). Else it should instead
use its IPv6 address as the Instance Name. For example, if the registrar is just a software application not
knowing the specifics of the hardware it is running on, the MAC address <span class="bcp14">MUST NOT</span> be used. If only mDNS is used
(as in this example), then the IPv6 link-local address would also suffice as the Instance Name.<a href="#section-3.8.1.2-9" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-10">In this example, a single Instance Name suffices, because BRSKI and cBRSKI are two separate service
contexts: they are distinguished by different protocols: TCP vs. UDP.<a href="#section-3.8.1.2-10" class="pilcrow">¶</a></p>
<span id="name-dns-sd-for-a-brski-registra"></span><div id="dnssd-example-2">
<figure id="figure-3">
              <div class="alignLeft art-text artwork" id="section-3.8.1.2-11.1">
<pre>
0123456789012345678901234567890123456789012345678901234567890123456789
                   _brski-registrar._tcp.local
               IN PTR  0200:0000:7400-rrm._brski-registrar._tcp.local
0200:0000:7400-rrm._brski-registrar._tcp.local
               IN SRV  1 2 4555 0200:0000:7400-rrm.local
0200:0000:7400-rrm._brski-registrar._tcp.local IN TXT ""
0200:0000:7400-rrm.local
               IN AAAA fda3:79a6:f6ee:0000::0200:0000:6400:0001

                   _brski-registrar._tcp.local
               IN PTR 0200:0000:7400-prm._brski-registrar._tcp.local
0200:0000:7400-prm._brski-registrar._tcp.local
               IN SRV 1 2 4555 0200:0000:7400-prm.local
0200:0000:7400-prm._brski-registrar._tcp.local
               IN TXT "prm" "cmp"
0200:0000:7400-prm.local
               IN AAAA fda3:79a6:f6ee:0000::0200:0000:6400:0001
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-dns-sd-for-a-brski-registra" class="selfRef">DNS-SD for a BRSKI registrar supporting RRM and PRM</a>
              </figcaption></figure>
</div>
<p id="section-3.8.1.2-12">In the second example <a href="#dnssd-example-2" class="auto internal xref">Figure 3</a>, a registrar needs to use two different Instance Names, because both
share the same service context: BRSKI - TCP with service name brski-registrar. In this example, the registrar
offers "rrm" mode with "cms" voucher and "est" enrollment. It also offers "prm" mode with "cms" voucher,
but (only) with "cmp" enrollment protocol. Because the registrar does not offer "rrm" with "cmp", or
"prm" with "est", it is not possible to coalesce all variations under one Instance Name, so instead, two
Instance Names have to be created, and with them the necessary (duplicate) RR.<a href="#section-3.8.1.2-12" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-13">Note that the "-rrm" and "-prm" in the Instance Names are only explanatory and could be any mutually unique
strings - as is true for the whole Instance Name.<a href="#section-3.8.1.2-13" class="pilcrow">¶</a></p>
<p id="section-3.8.1.2-14">Note too, that because both Instances share the same port number 4555 (and hence TCP socket), they both have
to be provided by the same BRSKI application. If two separate applications where to be started on the
dame host, one for "rrm", the other for "prm", then they would have separate sockets and hence port numbers.<a href="#section-3.8.1.2-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="grasp">
<section id="section-3.8.2">
          <h4 id="name-grasp">
<a href="#section-3.8.2" class="section-number selfRef">3.8.2. </a><a href="#name-grasp" class="section-name selfRef">GRASP</a>
          </h4>
<div id="signaling-1">
<section id="section-3.8.2.1">
            <h5 id="name-signaling-2">
<a href="#section-3.8.2.1" class="section-number selfRef">3.8.2.1. </a><a href="#name-signaling-2" class="section-name selfRef">Signaling</a>
            </h5>
<p id="section-3.8.2.1-1">This document does not specify a mandatory to implement set of signaling options to guarantee
interoperability of discovery between initiator and responders when using GRASP. Like for the
other discovery mechanisms, these requirements will have to come from other specifications
that outline what in <a href="#GRASP" class="auto internal xref">Section 1</a> is called the "security and transport substrate" to be used for
GRASP.<a href="#section-3.8.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.8.2.1-2"><span>[<a href="#RFC8994" class="cite xref">RFC8994</a>]</span> specifies one such "security and transport substrate", which is zero-touch deployable.
It is mandatory to support for initiators and responders implementing the so-called
"Autonomic Network Infrastructure" (ANI). DULL GRASP is used for link-local discovery of
proxies, and the ACP is used to automatically and securely build the connectivity for multi-hop discovery
of registrars by proxies.<a href="#section-3.8.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding-1">
<section id="section-3.8.2.2">
            <h5 id="name-encoding-2">
<a href="#section-3.8.2.2" class="section-number selfRef">3.8.2.2. </a><a href="#name-encoding-2" class="section-name selfRef">Encoding</a>
            </h5>
<p id="section-3.8.2.2-1">To announce protocol variations with <a href="#GRASP" class="auto internal xref">Section 1</a>, the supported Variation is indicated in the
objective-value field of the GRASP objective, using the method of forming the Variation string term
in <a href="#variation" class="auto internal xref">Section 3.5.3</a>, and listed in the Variation String column of the <a href="#fig-variations" class="auto internal xref">Table 3</a> table.<a href="#section-3.8.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.8.2.2-2">If more than one Variation is supported, then multiple objectives have to be announced, each with
a different objective-value, but the same location information if the different Variations are
supported across the same socket. Different sockets require different objective structures in GRASP anyhow.<a href="#section-3.8.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.8.2.2-3">Compared to DNS-SD, the choice of encoding for GRASP optimizes for minimum parsing effort, whereas
the DNS-SD encoding is optimized for most compact encoding given the limit for DNS-SD TXT records.<a href="#section-3.8.2.2-3" class="pilcrow">¶</a></p>
<span id="name-grasp-example-for-a-brski-r"></span><div id="grasp-example-1">
<figure id="figure-4">
              <div class="alignLeft art-text artwork" id="section-3.8.2.2-4.1">
<pre>
[M_FLOOD, 12340815, h'fe800000000000000000000000000001', 180000,
    [["AN_Proxy", 4, 1, "",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_TCP, 4443],
     ["AN_Proxy", 4, 1, "prm",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_TCP, 4443],
     ["AN_Proxy", 4, 1, "",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_UDP, 4684]]
]
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-grasp-example-for-a-brski-r" class="selfRef">GRASP example for a BRSKI registrar supporting RRM and PRM</a>
              </figcaption></figure>
</div>
<p id="section-3.8.2.2-5"><a href="#grasp-example-1" class="auto internal xref">Figure 4</a> is an example for a GRASP service announcement for "AN_Proxy" in support of BRSKI
with both "rrm" and "prm" supported on the same socket (TCP port number) and for cBRSKI with
COAP over DTLS.<a href="#section-3.8.2.2-5" class="pilcrow">¶</a></p>
<p id="section-3.8.2.2-6">Note that one or more complete service instances (in the example 3) can be contained within a single GRASP message
without the need for any equivalent to the Service Instance Name of the DNS-SD PTR RR or the
Target name of the DNS-SD SRV RR. DNS-SD requires them because its encoding is
decomposed into different RR, but it also intentionally introduces the Service Instance Name
as an element for human interaction with selection (browsing and/or diagnostics of selection),
something that the current GRASP objective-value encoding does not support.<a href="#section-3.8.2.2-6" class="pilcrow">¶</a></p>
<p id="section-3.8.2.2-7">Because this GRASP encoding does not support service instance name, examples such as<a href="#section-3.8.2.2-7" class="pilcrow">¶</a></p>
<span id="name-grasp-example-with-two-diff"></span><div id="grasp-example-2">
<figure id="figure-5">
              <div class="alignLeft art-text artwork" id="section-3.8.2.2-8.1">
<pre>
[M_FLOOD, 12340815, h'fe800000000000000000000000000001', 180000,
    [["AN_Proxy", 4, 1, "",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_TCP, 4443],
     ["AN_Proxy", 4, 1, "",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_UDP, 4684]]
]

[M_FLOOD, 42310815, h'fe800000000000000000000000000001', 180000,
    [["AN_Proxy", 4, 1, "prm",
     [O_IPv6_LOCATOR,
     h'fe800000000000000000000000000001', IPPROTO_TCP, 44000]]
]
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-grasp-example-with-two-diff" class="selfRef">GRASP example with two different processes</a>
              </figcaption></figure>
</div>
<p id="section-3.8.2.2-9">In <a href="#grasp-example-2" class="auto internal xref">Figure 5</a>, A separate application process supports "prm" and hence
uses a separate socket, with example TCP port 44000. In this case, there is
no need nor significant benefit to merge all service instance announcements into
a single GRASP message. Instead, the BRSKI-"rrm"/cBRSKI process would be
able to generate and send its own, first, message shown in the example, and the
second process would send its own, second message in the example.<a href="#section-3.8.2.2-9" class="pilcrow">¶</a></p>
<p id="section-3.8.2.2-10">For a more extensive, DNS-SD compatible encoding of the objective-value that also
support Service Instance Names, see <span>[<a href="#I-D.eckert-anima-grasp-dnssd" class="cite xref">I-D.eckert-anima-grasp-dnssd</a>]</span>.<a href="#section-3.8.2.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="core-lf">
<section id="section-3.8.3">
          <h4 id="name-core-lf">
<a href="#section-3.8.3" class="section-number selfRef">3.8.3. </a><a href="#name-core-lf" class="section-name selfRef">CORE-LF</a>
          </h4>
<p id="section-3.8.3-1">"Web Linking", <span>[<a href="#RFC5988" class="cite xref">RFC5988</a>]</span> defines a format, originally for use with
HTTP headers, to link an HTTP document against other URIs. Web linking is not a standalone
method for discovery of services for use with HTTP.<a href="#section-3.8.3-1" class="pilcrow">¶</a></p>
<p id="section-3.8.3-2">Based on Web Linking, "Constrained RESTful Environments (CoRE) Link Format", <a href="#CORE-LF" class="auto internal xref">Section 1</a> introduces a
stand alone method to discover services instances, which are called resources in CORE-LF;
primarily for use with <a href="#COAP" class="auto internal xref">Section 1</a> but equally for use with, for use with HTTP or any other suitable web transfer protocols.<a href="#section-3.8.3-2" class="pilcrow">¶</a></p>
<p id="section-3.8.3-3">In CORE-LF, an initiator may use (link-local) IPv6 multicast UDP packet to the COAP port (5683)
to discover a a possible responder for a specifically requested resource. The responder will reply with unicast UDP.
If the IPv6 address of a responder has been configured or is otherwise known to the initiator, it
may equally query the parameters of the desired resource via unicast to the default COAP UDP or
TCP port (5683).<a href="#section-3.8.3-3" class="pilcrow">¶</a></p>
<p id="section-3.8.3-4">A service such as BRSKI registrar, join proxy or pledge can be considered to be a resource, but it
can equally be broken down into a set of component resources resources, in which case the group
can be requested. As mentioned above, CORE-LF can equally be used to request and discover resources
not using COAP, but any other suitable protocol.<a href="#section-3.8.3-4" class="pilcrow">¶</a></p>
<p id="section-3.8.3-5"><span>[<a href="#RFC9176" class="cite xref">RFC9176</a>]</span> defines a "Resource Directory" mechanism for CORE-LF which is abbreviated CORE-RD. Initiators
can learn the IPv6 address protocol (TCP or UDP) and port numberaof a CORE-RD server by some other
mechanism (such as DNS-SD) and then use a unicast UDP or TCP COAP connection to the CORE-RD server
to discover CORE-LF resources available on other systems. Resource providers can likewise register
their resources with the resource directory server using CORE-RD registration procedures.<a href="#section-3.8.3-5" class="pilcrow">¶</a></p>
<p id="section-3.8.3-6">In summaery, CORE-LF including CORE-RD is a mechanism for registration and discovery of resources and
hence services which may be preferred in deployments over other options and can equally be applicable
to register/discover any variation of BRSKI for any type of BRSKI service.<a href="#section-3.8.3-6" class="pilcrow">¶</a></p>
<div id="signaling-2">
<section id="section-3.8.3.1">
            <h5 id="name-signaling-3">
<a href="#section-3.8.3.1" class="section-number selfRef">3.8.3.1. </a><a href="#name-signaling-3" class="section-name selfRef">Signaling</a>
            </h5>
<div id="existing-definitions">
<section id="section-3.8.3.1.1">
              <h6 id="name-existing-definitions">
<a href="#section-3.8.3.1.1" class="section-number selfRef">3.8.3.1.1. </a><a href="#name-existing-definitions" class="section-name selfRef">Existing definitions</a>
              </h6>
<p id="section-3.8.3.1.1-1"><a href="#cBRSKI" class="auto internal xref">Section 1</a> specifies the use of CORE-LF as a reference methods
for pledges to discover registrars - in the absence of any proxies, to allow deployments
of scenarios where no proxies are needed - and hence also where <a href="#cBRSKI" class="auto internal xref">Section 1</a>.
is not needed. Because BRSKI is designed so that pledges can be agnostic of whether they connect
to a registrar directly or via a proxy, the resource/service that the pledge needs to discover
is nevertheless called "(brski) join proxy (for pleges)", and encoded in CORE-LF as the value
"brski.jp" for the resource type attribute ("rt=resource-type") according to <a href="#CORE-LF" class="auto internal xref">Section 1</a>.<a href="#section-3.8.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.1-2">The following picture, <a href="#corelf-example-1" class="auto internal xref">Figure 6</a> shows the encoding and an example of this discovery.
"ff02::fd" is the link-local scope address for "All Coap Nodes" in IPv6, as introduced in <span>[<a href="#RFC7390" class="cite xref">RFC7390</a>]</span>,
which also defines IPv6 and site-scoped address options.<a href="#section-3.8.3.1.1-2" class="pilcrow">¶</a></p>
<span id="name-core-lf-discovery-of-regist"></span><div id="corelf-example-1">
<figure id="figure-6">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.1-3.1">
<pre>
Template:

REQ: GET coap://[All_Coap_Nodes_IP_multicast_addr]/.well-known/core?rt=brski.jp

RES: 2.05 Content
   &lt;coaps://[Responder_IP_unicast_address]:join-port&gt;; rt="brski.jp"

Example:

REQ: GET coap://[ff02::fd]/.well-known/core?rt=brski.jp

RES: 2.05 Content
   &lt;coaps://[fe80::c78:e3c4:58a0:a4ad]:8485&gt;;rt=brski.jp
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-core-lf-discovery-of-regist" class="selfRef">CORE-LF discovery of registrar/proxy by pledges</a>
                </figcaption></figure>
</div>
<p id="section-3.8.3.1.1-4"><a href="#cPROXY" class="auto internal xref">Section 1</a> introduces the operations of a CoAP based join proxy
both as a connection based proxy as in <a href="#BRSKI" class="auto internal xref">Section 1</a> (only using UDP connections for COAPs instead
of TCP for TLS as in <a href="#BRSKI" class="auto internal xref">Section 1</a>), but also as a new, stateless join proxy - to eliminate the
need for potentially highly constrained join proxy nodes to keep connection state and avoid
the complexity of protecting that state against attacks. The new resource type "brski.rjp" is
defined to support stateless join proxies to discover registrars and their UDP port number
that support the stateless, so-called JPY protocol.<a href="#section-3.8.3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.1-5">The following picture, <a href="#corelf-example-2" class="auto internal xref">Figure 7</a> shows the encoding and an example of this discovery.
<a href="#cPROXY" class="auto internal xref">Section 1</a> introduces the new scheme "coaps+jpy" for the packet
header used by the stateless JPY" protocol. The request in the template is assumed to be
based on unicast, relying on another method to discover the IP address of the registrar first.
It could equally use COAP site-scoped IP multicast, but in general, the assumeption is that
registrar will not necessarily be link-local connected to proxies (this may be different in
specific deployments). Even though the registrar IP address is hence known, the reply still
needs to include this address again because in the <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span> link format, and <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span>, Section 3.2, the
authority attribute can not include a port number unless it also includes the IP address.<a href="#section-3.8.3.1.1-5" class="pilcrow">¶</a></p>
<span id="name-core-lf-discovery-of-registr"></span><div id="corelf-example-2">
<figure id="figure-7">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.1-6.1">
<pre>
Template:

REQ: GET /.well-known/core?rt=brski.jpy

RES: 2.05 Content
     &lt;coaps+jpy://[Responder_IP_unicast_address]:join-port&gt;;rt=brski.jpy

Example:

REQ: GET /.well-known/core?rt=brski.jpy

RES: 2.05 Content
     &lt;coaps+jpy://[2001:db8:0:abcd::52]:7633&gt;;rt=brski.jpy
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-core-lf-discovery-of-registr" class="selfRef">CORE-LF discovery of registrars that support stateless JPY protocll by proxies</a>
                </figcaption></figure>
</div>
</section>
</div>
<div id="new-variation-discovery">
<section id="section-3.8.3.1.2">
              <h6 id="name-new-variation-discovery">
<a href="#section-3.8.3.1.2" class="section-number selfRef">3.8.3.1.2. </a><a href="#name-new-variation-discovery" class="section-name selfRef">New variation discovery</a>
              </h6>
<p id="section-3.8.3.1.2-1">This document expands the above summarized existing CORE-LF definitions from
<a href="#cBRSKI" class="auto internal xref">Section 1</a> and <a href="#cPROXY" class="auto internal xref">Section 1</a> as follows.<a href="#section-3.8.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-2">Discovery of stateful sockets on a registrar uses the resource type "brski.rs" (for
"registrar (for) join proxies stateful)" - instead of "brski.rjpy" for the previosly
defined stateless connection mode.<a href="#section-3.8.3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-3">The following picture <a href="#corelf-example-3" class="auto internal xref">Figure 8</a> show template and example of this discovery option.
In Example 1, the registrar is running on a separate port 7634 from the COREs UDP port, so
this response needs to also include the IP address of the responding registrar (as explained
above). In Example 2, the registar functions are provided via the default (potentially shared)
COAPS port, so this is not necessary. In both cases, the response include a shorter URL part
"/b/s" which allows that the service can be used via that shorter prefix than the default
"/.well-known/brksi", hence shortening the required COAPS packet sizes.<a href="#section-3.8.3.1.2-3" class="pilcrow">¶</a></p>
<span id="name-core-lf-discovery-of-registra"></span><div id="corelf-example-3">
<figure id="figure-8">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.2-4.1">
<pre>
Template:

REQ: GET /.well-known/core?rt=brski.r(*|s|spy)

RES: 2.05 Content
     &lt;scheme://[Responder_IP_unicast_address]:join-port&gt;;rt=brski.(rjpy|rs)

Example 1:

REQ: GET /.well-known/core?rt=brski.rs

RES: 2.05 Content
     &lt;coaps://[2001:db8:0:abcd::52]:7634/b/s&gt;;rt=brski.rs

Example 2:

REQ: GET /.well-known/core?rt=brski.rjpy

RES: 2.05 Content
     &lt;/b/s&gt;;rt=brski.rjpy
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-core-lf-discovery-of-registra" class="selfRef">CORE-LF discovery of registrars that support stateless JPY protocll by proxies</a>
                </figcaption></figure>
</div>
<p id="section-3.8.3.1.2-5">TBD: Question: can we really reply without coaps given how we always want coaps - aka: the query itself
may not have been coaps ?? This is  question for constrained proxy/voucher - can we rightfully (according to
IETF specs) make the expection that even though the resource discovery is done insecure, that it is understood
that the actual resource consumption has to use coaps ????  - question for COAP experts.<a href="#section-3.8.3.1.2-5" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-6">Explanations:<a href="#section-3.8.3.1.2-6" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-7">The discovery and distinction between a stateless and stateful registrar socket is orthogonal
to the concept of a variation of BRSKI as defined in this document. Therefore, the distinction
between a stateless and stateless socket on a registrar is provided solely via the CORE-LF
resource-type, "brski.rjpy" (stateless) and "brski.rs" (stateful). In other words, the "rt"
attribute in CORE-LF serves as the abstract "Service Name" in this document. If discover
of stateless join proxies was required with other discovery mechanisms such as GRASP or
DNS-SD, then new "Service Name" equivalents in those discovery mechanisms would need to be
defined. For the purpose of this document, it is assumed that stateless proxy operations
is well enough supported with CORE-LF.<a href="#section-3.8.3.1.2-7" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-8">To indicate variations other than the default combination implied by <a href="#cBRSKI" class="auto internal xref">Section 1</a>
and <a href="#cPROXY" class="auto internal xref">Section 1</a>, this document specifies the new "bv" (brski variation)
attribute for CORE-LF records, which is specified relative only to "rt=brski.r*" resource targets.<a href="#section-3.8.3.1.2-8" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-9">The value to the "bv=" attribute is a flattened string of the non-default Variation Type Choices
as specified for GRASP, so that CORE-LF does not introduce another registry table to maintain.
The only difference is that the absence of the "bv=" attribute is equivalent to the
actual defaults established by <a href="#cBRSKI" class="auto internal xref">Section 1</a> and <a href="#cPROXY" class="auto internal xref">Section 1</a>,
namely "rrm" (registrar response-mode) with "cose" (CBOR with COSE signed voucher) and "est" - enrollment
via the 'fitting' variation of EST, in the case of using COAPS it is <span>[<a href="#RFC9148" class="cite xref">RFC9148</a>]</span>, e.g.: EST over COAPS.
Including or excluding "bv=" (empty value) is hence equivalent to "bs=cose", aka: the default variation
over COAPS.<a href="#section-3.8.3.1.2-9" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-10">When a variation implies use of HTTPS (or in the future any other transport other than COAPS), then
the schema, and hence IP-address needs to be included in the CORE-LF response. Likewise, even if the
protocol schema is coaps, then the IP address needs to be included if the resource is not served on
the standard COAPS UDP port.<a href="#section-3.8.3.1.2-10" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-11">[ Q: How does the schema indicate UDP versus TCP for COAPS ??? ]<a href="#section-3.8.3.1.2-11" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-12">The following <a href="#corelf-example-4" class="auto internal xref">Figure 9</a> shows the schema and an example for various BRSKI registar
variations, discovered via CORE-LF.<a href="#section-3.8.3.1.2-12" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-13">"rt=brski.rs" with schema "coaps" and without any "bv" attribute indicate the default combination
of "rrm", "cose" and "est" (EST via COAPS), as introduced by <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>,
aka: stateful cBRSKI.<a href="#section-3.8.3.1.2-13" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-14">"rt=brski.rjpy" with schema "coaps+jpy" and without any "bv" attribute indicate the default combination
of "rrm", "cose" and "est" (EST via COAPS), as introduced by <span>[<a href="#I-D.ietf-anima-constrained-join-proxy" class="cite xref">I-D.ietf-anima-constrained-join-proxy</a>]</span>,
aka: stateless proxy cBRSKI, using the JPY header.<a href="#section-3.8.3.1.2-14" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-15">In both cases, there is no "bv=" attribute, so that the absence of the "bv" attribute indicates
backward compatibility with existing definitions from <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span> and
<span>[<a href="#I-D.ietf-anima-constrained-join-proxy" class="cite xref">I-D.ietf-anima-constrained-join-proxy</a>]</span>.<a href="#section-3.8.3.1.2-15" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-16">"rt=brski.rs" with schema "https" and with "bv=" indicates <a href="#BRSKI" class="auto internal xref">Section 1</a> with its default variation
of "rrm", "cms" and "est". As there is no mechanism to support the JPY header via TCP (for https),
there is no schema "https+jpy" option.<a href="#section-3.8.3.1.2-16" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-17">"rt=brski.rs" with schema "https" and with "bv=cmp" indicates the variation "rrm", "cms" and "cmp"
as introduced by <a href="#BRSKI-AE" class="auto internal xref">Section 1</a>, and "rt=brski.rs" with schema "https" and with "bv=prm-jose" indicates
 the variation "prm", "jose" and "cmp" as introduced by <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>.<a href="#section-3.8.3.1.2-17" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-18">Note that the variation type value of "est" does mean different protocol specifications depending
on the transport. Over "https" it means <a href="#EST" class="auto internal xref">Section 1</a>, whereas over COAPS it means <span>[<a href="#RFC9148" class="cite xref">RFC9148</a>]</span>.<a href="#section-3.8.3.1.2-18" class="pilcrow">¶</a></p>
<span id="name-core-lf-discovery-of-registrar"></span><div id="corelf-example-4">
<figure id="figure-9">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.2-19.1">
<pre>
Template:

REQ: GET /.well-known/core?rt=brski.r*

RES: 2.05 Content
     &lt;scheme://[Responder_IP_unicast_address]:join-port&gt;;\
       rt=brski.r*(;brv=brski-variation-string)

Example:

REQ: GET /.well-known/core?rt=brski.r*

RES: 2.05 Content
     &lt;coaps://[2001:db8:0:abcd::52]:7634/b&gt;;rt=brski.rs,
     &lt;coaps+jpy://[2001:db8:0:abcd::52]:7633/b&gt;;rt=brski.rjpy,
     &lt;https://[2001:db8:0:abcd::52]:7634/b&gt;;rt=brski.rs;bv=,
     &lt;https://[2001:db8:0:abcd::52]:7634/b&gt;;rt=brski.rs;bv=cmp,
     &lt;https://[2001:db8:0:abcd::52]:7634/b&gt;;rt=brski.rs;bv=prm-jose,
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-core-lf-discovery-of-registrar" class="selfRef">CORE-LF discovery of registrars by a proxy for different BRSKI variations</a>
                </figcaption></figure>
</div>
<p id="section-3.8.3.1.2-20">The following <a href="#corelf-example-5" class="auto internal xref">Figure 10</a> shows variations that have not explicitly been defined
in existing specifications, so it is more or less unless whether they will work withough
additional specification of details to allow interoperability. Specifically, it is unclear
whether "endpoint" protocols defined for "http" transport will equall work over "coaps"
transport without additional specification.<a href="#section-3.8.3.1.2-20" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-21">For this reason, such variations are not explicitly assumed to be supportable, but included
as candidarte, subject to additional specification, and/or expert review.<a href="#section-3.8.3.1.2-21" class="pilcrow">¶</a></p>
<span id="name-potential-future-registrar-"></span><div id="corelf-example-5">
<figure id="figure-10">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.2-22.1">
<pre>
RES: 2.05 Content
     &lt;coapsy://[2001:db8:0:abcd::52]:7633/b&gt;;rt=brski.rsy;bv=cose-cmp,
     &lt;coaps+jpy://[2001:db8:0:abcd::52]:7633/b&gt;;rt=brski.rjpy;bv=cose-cmp,
     &lt;https://[2001:db8:0:abcd::52]:7634/b2&gt;;rt=brski.rjps;bv=jose-cmp,
     &lt;https://[2001:db8:0:abcd::52]:7634/b3&gt;;rt=brski.rjps;bv=cose-cmp
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-potential-future-registrar-" class="selfRef">Potential ? future registrar variations</a>
                </figcaption></figure>
</div>
<p id="section-3.8.3.1.2-23">[ Q: Can we actually use the * discovery to only discover the two variations of
registrar transport variations "rj*" - when we are a registrar ??? we do not want to
discover the resource that proxies or registrars provide to pledges!!! ]<a href="#section-3.8.3.1.2-23" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-24">When pledges need to discover (and select)  proxies (or registrars) supporting a specific
combination of variations, the encoding of attributes is the same as shown in
<a href="#corelf-example-3" class="auto internal xref">Figure 8</a> except that now, "rt=brski.jp" needs to be discovered.<a href="#section-3.8.3.1.2-24" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-25">It is a responsibility of the proxy to discover registrars and map their discovered "bv=" variations
for rt=brski.rjp" and/or "brski.rjps" to the same "bv=" variations to their announced "rt=brski.jp"
resources: For provies, there is simply a 1:1 mapping of the "bv" attribute and the connection scheme
for the resources discovered from registrars, except for the subset of variations that can rely
on COAPS transport, for those both the "rt=brski.rjp" and "rt=brski.rjps" are options how to
proxy the resource for the pleges.<a href="#section-3.8.3.1.2-25" class="pilcrow">¶</a></p>
<p id="section-3.8.3.1.2-26">Note that the port numbers announced by the proxy resources will of course likely be different than
those announced by the registarars.<a href="#section-3.8.3.1.2-26" class="pilcrow">¶</a></p>
<span id="name-core-lf-discovery-of-registrars"></span><div id="corelf-example-6">
<figure id="figure-11">
                <div class="alignLeft art-text artwork" id="section-3.8.3.1.2-27.1">
<pre>
Template:

REQ: GET /.well-known/core?rt=brski.jp

RES: 2.05 Content
     &lt;scheme://[Responder_IP_unicast_address]:join-port&gt;;\
         rt=brski.jp(;brv=brski-variation-string)

Example:

REQ: GET /.well-known/core?rt=brski.rj*

RES: 2.05 Content
     &lt;coaps://[2001:db8:0:abcd::52]:7734/b&gt;;rt=brski.jp,
     &lt;https://[2001:db8:0:abcd::52]:7734/b&gt;;rt=brski.jp;bv=,
     &lt;https://[2001:db8:0:abcd::52]:7734/b2&gt;;rt=brski.jp;bv=jose-cmp,
     &lt;https://[2001:db8:0:abcd::52]:7734/b3&gt;;rt=brski.jp;bv=cose-cmp
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-core-lf-discovery-of-registrars" class="selfRef">CORE-LF discovery of registrars or proxies by pledges for various BRSKI variations</a>
                </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="updates-to-existing-rfcs">
<section id="section-4">
      <h2 id="name-updates-to-existing-rfcs">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-updates-to-existing-rfcs" class="section-name selfRef">Updates to existing RFCs</a>
      </h2>
<div id="rfc8995">
<section id="section-4.1">
        <h3 id="name-rfc8995">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-rfc8995" class="section-name selfRef">RFC8995</a>
        </h3>
<p id="section-4.1-1">TBD.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA considerations</a>
      </h2>
<div id="registry">
<section id="section-5.1">
        <h3 id="name-brski-variations-discovery-r">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-brski-variations-discovery-r" class="section-name selfRef">BRSKI Variations Discovery Registry (section)</a>
        </h3>
<p id="section-5.1-1">This document requests a new section named "BRSKI Variations Discovery Parameters"
in the "Bootstrapping Remote Secure Key Infrastructures (BRSKI) Parameters"
registry (https://www.iana.org/assignments/brski-parameters/brski-parameters.xhtml).
Its initial content is as follows.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">[ RFC editor. Please remove the following sentence.
Note to IANA: This section contains three tables according to the specifications of this document.
Each of these tables should include the table title so that they can be more easily
distinguished.  If it is not possible to introduce more than one table per section, then we will modify the request
accordingly for three sections, but given how the three tables are tightly linked, that would be unfortunate. ]<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Registration Procedure(s):
  Standards action or expert review based on registration.  See ThisRFC.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">Experts:
  TBD.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Reference:
  ThisRFC.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Notes:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-7">
          <dt id="section-5.1-7.1">Dflt flag:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-7.2">
            <p id="section-5.1-7.2.1">Indicates a Variation Type Choice that is assumed to be used if the service discover/selection mechanism does not indicate any variation.<a href="#section-5.1-7.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-7.3">Rsvd Flag:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-7.4">
            <p id="section-5.1-7.4.1">Indicates a Variation Type Choice that is reserved for use with the mechanism described in the Note(s) column, but for which no specification yet exists.<a href="#section-5.1-7.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-7.5">Spec / Applicability:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-7.6">
            <p id="section-5.1-7.6.1">A "-" indicates that the variation is considered to be feasible through existing specifications, but not explicitly mentioned in them.
An "NA" indicates that the combination is assumed to be not working with the currently available specifications.<a href="#section-5.1-7.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-brski-variation-contexts"></span><div id="fig-contexts">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-brski-variation-contexts" class="selfRef">BRSKI Variation Contexts</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Context</th>
              <th class="text-left" rowspan="1" colspan="1">Applicable Variation Types</th>
              <th class="text-left" rowspan="1" colspan="1">Discovery Mechanism</th>
              <th class="text-left" rowspan="1" colspan="1">Service Name(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">mode<br>vformat<br>enroll</td>
              <td class="text-left" rowspan="1" colspan="1">GRASP</td>
              <td class="text-left" rowspan="1" colspan="1">"AN_join_registrar" /<br> "AN_Proxy"<br>with IPPROTO_TCP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DNS-SD</td>
              <td class="text-left" rowspan="1" colspan="1">"brski-registrar" /<br> "brski-proxy"<br> with TCP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cBRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">mode<br>vformat<br>enroll</td>
              <td class="text-left" rowspan="1" colspan="1">GRASP</td>
              <td class="text-left" rowspan="1" colspan="1">"AN_join_registrar" /<br> "AN_join_registrar_rjp" /<br> "AN_Proxy"<br> with IPPROTO_UDP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">DNS-SD</td>
              <td class="text-left" rowspan="1" colspan="1">"brski-registrar" /<br> "brski-proxy"<br> with UDP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">CORE-LF</td>
              <td class="text-left" rowspan="1" colspan="1">rt=brski.*</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI-PLEDGE</td>
              <td class="text-left" rowspan="1" colspan="1">mode<br>vformat<br>enroll</td>
              <td class="text-left" rowspan="1" colspan="1">DNS-SD</td>
              <td class="text-left" rowspan="1" colspan="1">"brski-pledge" with TCP</td>
            </tr>
          </tbody>
        </table>
</div>
<span id="name-brski-variation-type-choices"></span><div id="fig-choices">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-brski-variation-type-choices" class="selfRef">BRSKI Variation Type Choices</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Context</th>
              <th class="text-left" rowspan="1" colspan="1">Variation Type</th>
              <th class="text-left" rowspan="1" colspan="1">Variation Type Choice</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Flags</th>
              <th class="text-left" rowspan="1" colspan="1">Note(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI, cBRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">mode</td>
              <td class="text-left" rowspan="1" colspan="1">rrm</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span><br>ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">Registrar Responder Mode <br> the mode specified in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">prm</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC  <br>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Pledge Responder Mode    <br> <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">vformat</td>
              <td class="text-left" rowspan="1" colspan="1">cms</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8368" class="cite xref">RFC8368</a>]</span><br>ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">CMS-signed JSON Voucher  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cose</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC<br>
</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">CBOR with COSE signature<br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cBRSKI</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cose</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC<br>
</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR with COSE signature <br> <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cms</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8368" class="cite xref">RFC8368</a>]</span><br>ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">CMS-signed JSON Voucher  <br>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI, cBRSKI</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">jose</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC<br>
</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt*</td>
              <td class="text-left" rowspan="1" colspan="1">JOSE-signed JSON, Default when prm is used<br> <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>, <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI-PLEDGE</td>
              <td class="text-left" rowspan="1" colspan="1">mode</td>
              <td class="text-left" rowspan="1" colspan="1">prm</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">Pledge responder Mode<br><span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">vformat</td>
              <td class="text-left" rowspan="1" colspan="1">jose</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">JOSE-signed JSON, Default when prm is used<br> <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>, <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cms</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Rsvd</td>
              <td class="text-left" rowspan="1" colspan="1">CMS-signed JSON Voucher, not specified.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cose</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Rsvd</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR with COSE signature, not specified.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI, cBRSKI, BRSKI-PLEDGE</td>
              <td class="text-left" rowspan="1" colspan="1">enroll</td>
              <td class="text-left" rowspan="1" colspan="1">est</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span><br><span>[<a href="#RFC7030" class="cite xref">RFC7030</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">Dflt</td>
              <td class="text-left" rowspan="1" colspan="1">Enroll via EST           <br> as specified in <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>, extension for <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a> when used in context BRSKI-PLEDGE&lt;br}<span>[<a href="#RFC9148" class="cite xref">RFC9148</a>]</span> when used over COAP</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">cmp</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Lightweight CMP Profile  <br> {I-D.ietf-anima-brski-ae}}, <span>[<a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="cite xref">I-D.ietf-lamps-lightweight-cmp-profile</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">scep</td>
              <td class="text-left" rowspan="1" colspan="1">ThisRFC</td>
              <td class="text-left" rowspan="1" colspan="1">Rsvd</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8894" class="cite xref">RFC8894</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
<span class="break"></span><dl class="dlParallel" id="section-5.1-10">
          <dt id="section-5.1-10.1">Note 1:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-10.2">
            <p id="section-5.1-10.2.1">The Variation String "EST-TLS" is equivalent to the Variation String "" and is required and only permitted for the AN_join_registrar objective value in GRASP for backward compatibility with RFC8995, where it is used for this variation. Note that AN_proxy uses "".<a href="#section-5.1-10.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="fig-variations">
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Context</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Variation String</th>
              <th class="text-left" rowspan="1" colspan="1">Variations</th>
              <th class="text-left" rowspan="1" colspan="1">Explanations / Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">BRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"" / "EST-TLS"</td>
              <td class="text-left" rowspan="1" colspan="1">rrm cms  est</td>
              <td class="text-left" rowspan="1" colspan="1">Note 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">cmp</td>
              <td class="text-left" rowspan="1" colspan="1">rrm cms  cmp</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">prm-jose</td>
              <td class="text-left" rowspan="1" colspan="1">prm jose est</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cBRSKI</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"" / "rrm-cose"</td>
              <td class="text-left" rowspan="1" colspan="1">rrm cose est</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="service-names-registry">
<section id="section-5.2">
        <h3 id="name-service-names-registry">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-service-names-registry" class="section-name selfRef">Service Names Registry</a>
        </h3>
<p id="section-5.2-1">IANA is asked to modify and amend the "Service Name and Transport Protocol Port Number Registry" registry (https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.txt) as follows:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">brski-proxy and brski-registrar are to be added as Service Names for the "udp" protocol using ThisRFC as the reference.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">The registrations for brski-proxy and brski-registrar for the "tcp" protocol are to be updated to also include ThisRFC as their reference.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">The Defined TXT keys column for brski-proxy and brski-registrar for both "tcp" and "udp" protocols are to state the following text:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">See ThisRFC and the "BRSKI Variation Type Choices" table in the "Bootstrapping Remote Secure Key Infrastructures (BRSKI) Parameters" registry.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">TBD: This request likely does not include all the necessary formatting.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="brski-well-known-uris-fixes-opportunistic">
<section id="section-5.3">
        <h3 id="name-brski-well-known-uris-fixes">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-brski-well-known-uris-fixes" class="section-name selfRef">BRSKI Well-Known URIs fixes (opportunistic)</a>
        </h3>
<p id="section-5.3-1">The following change requests to "https://www.iana.org/assignments/brski-parameters/brski-parameters.xhtml#brski-well-known-uris" are cosmetic in nature and are included in this document solely because support for Endpoint URIs is implied by the mechanisms specified in this document and the existing registry has these cosmetic issues.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">IANA is asked to change the name of the first column of the table from "URI" to "URI Suffix". This is in alignment with other table columns with the same syntax/semantic, such as "https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml".<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">IANA is asked to change the Reference from <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> to <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>], <a href="https://rfc-editor.org/rfc/rfc8995#section-8.3.1" class="relref">Section 8.3.1</a></span>.<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.3-2.3">
            <p id="section-5.3-2.3.1">IANA is asked to include the following "Note" text: The following table contains the assigned BRSKI protocol Endpoint URI suffixes under "/.well-known/brski"." - This note is added to introduce the term "Endpoint" into the registry table as that is the term commonly used (instead of URI) in several of the memos for which this discovery document was written. It is meant to help readers map the registry to the terminology used in those documents.<a href="#section-5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">In <a href="#BRSKI-PRM" class="auto internal xref">Section 1</a>, pledges are easier subject to DoS attacks than in <a href="#BRSKI" class="auto internal xref">Section 1</a>, because attackers
can be initiators and delay or prohibit enrollment of a pledge by opening so many connections to
the pledge that a valid registrar-agents connection to the pledge may not be possible. Discovery
of the pledge via DNS-SD increases the ability of attackers to discover pledges against which such
DoS attacks can be attempted.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Especially when supporting DNS-SD browsing across unicast DNS,
Pledges <span class="bcp14">MUST</span> implement DoS prevention measures, such as limiting the number and rate of accepted TCP
connections on a per-initiator basis. If feasible for the implementation, simultaneous connections
<span class="bcp14">SHOULD</span> be possible, so that an ongoing attacker connection will not delay a valid registrar-agent
connection. When accepting connections, a strategy such as LRU <span class="bcp14">MAY</span> be used to ensure that an attacker
will not be able to monopolize connections.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Browsing via DNS-SD, especially via unicast DNS which makes information available network-wide does
also introduce a perpass attack, gathering intelligence against what type and serial number of
devices are installed in the network. Whether or not this is seen as a relevant risk is highly
installation dependent. Networks <span class="bcp14">SHOULD</span> implement filtering measures at mDNS and/or DNS RR/services
level to prohibit such data collection if there is a risk, and this is seen as an undesirable attack
vector.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-7">
      <h2 id="name-acknowledgments">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-7-1">TBD.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="draft-considerations">
<section id="section-8">
      <h2 id="name-draft-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-draft-considerations" class="section-name selfRef">Draft considerations</a>
      </h2>
<div id="open-issues">
<section id="section-8.1">
        <h3 id="name-open-issues">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-open-issues" class="section-name selfRef">Open Issues</a>
        </h3>
<p id="section-8.1-1">Questions to the DNS-SD community.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">TBD<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="change-log">
<section id="section-8.2">
        <h3 id="name-change-log">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-change-log" class="section-name selfRef">Change log</a>
        </h3>
<p id="section-8.2-1">[RFC Editor: please remove this section.]<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">WG draft 02/03:<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Fix up tables to be correctly rendered by html output.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">WG draft 01:<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Core-LF improvements  / interim work.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">WG draft 00:<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7">Added section for CORE-LF. Still missing to update existing text with the CORE-LF definitions.<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<p id="section-8.2-8">Individual version 01:<a href="#section-8.2-8" class="pilcrow">¶</a></p>
<p id="section-8.2-9">Various enhancements<a href="#section-8.2-9" class="pilcrow">¶</a></p>
<p id="section-8.2-10">Individual version 00:<a href="#section-8.2-10" class="pilcrow">¶</a></p>
<p id="section-8.2-11">Initial version.<a href="#section-8.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-anima-brski-ae">[I-D.ietf-anima-brski-ae]</dt>
        <dd>
<span class="refAuthor">von Oheimb, D.</span>, <span class="refAuthor">Fries, S.</span>, and <span class="refAuthor">H. Brockhaus</span>, <span class="refTitle">"BRSKI-AE: Alternative Enrollment Protocols in BRSKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-ae-12</span>, <time datetime="2024-07-05" class="refDate">5 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-ae-12">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-ae-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-brski-prm">[I-D.ietf-anima-brski-prm]</dt>
        <dd>
<span class="refAuthor">Fries, S.</span>, <span class="refAuthor">Werner, T.</span>, <span class="refAuthor">Lear, E.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"BRSKI with Pledge in Responder Mode (BRSKI-PRM)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-prm-13</span>, <time datetime="2024-07-05" class="refDate">5 July 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-prm-13">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-prm-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-constrained-join-proxy">[I-D.ietf-anima-constrained-join-proxy]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Van der Stok, P.</span>, and <span class="refAuthor">P. Kampanakis</span>, <span class="refTitle">"Join Proxy for Bootstrapping of Constrained Network Elements"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-constrained-join-proxy-15</span>, <time datetime="2023-11-06" class="refDate">6 November 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-join-proxy-15">https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-join-proxy-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-constrained-voucher">[I-D.ietf-anima-constrained-voucher]</dt>
        <dd>
<span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Van der Stok, P.</span>, <span class="refAuthor">Kampanakis, P.</span>, and <span class="refAuthor">E. Dijk</span>, <span class="refTitle">"Constrained Bootstrapping Remote Secure Key Infrastructure (cBRSKI)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-constrained-voucher-24</span>, <time datetime="2024-03-03" class="refDate">3 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-voucher-24">https://datatracker.ietf.org/doc/html/draft-ietf-anima-constrained-voucher-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-jws-voucher">[I-D.ietf-anima-jws-voucher]</dt>
        <dd>
<span class="refAuthor">Werner, T.</span> and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"JWS signed Voucher Artifacts for Bootstrapping Protocols"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-jws-voucher-10</span>, <time datetime="2024-06-18" class="refDate">18 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-10">https://datatracker.ietf.org/doc/html/draft-ietf-anima-jws-voucher-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dnssd-srp">[I-D.ietf-dnssd-srp]</dt>
        <dd>
<span class="refAuthor">Lemon, T.</span> and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Service Registration Protocol for DNS-Based Service Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dnssd-srp-25</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dnssd-srp-25">https://datatracker.ietf.org/doc/html/draft-ietf-dnssd-srp-25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-lightweight-cmp-profile">[I-D.ietf-lamps-lightweight-cmp-profile]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, and <span class="refAuthor">S. Fries</span>, <span class="refTitle">"Lightweight Certificate Management Protocol (CMP) Profile"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-lightweight-cmp-profile-21</span>, <time datetime="2023-02-17" class="refDate">17 February 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-lightweight-cmp-profile-21">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-lightweight-cmp-profile-21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6763">[RFC6763]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"DNS-Based Service Discovery"</span>, <span class="seriesInfo">RFC 6763</span>, <span class="seriesInfo">DOI 10.17487/RFC6763</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6763">https://www.rfc-editor.org/rfc/rfc6763</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7030">https://www.rfc-editor.org/rfc/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7390">[RFC7390]</dt>
        <dd>
<span class="refAuthor">Rahman, A., Ed.</span> and <span class="refAuthor">E. Dijk, Ed.</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7390</span>, <span class="seriesInfo">DOI 10.17487/RFC7390</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7390">https://www.rfc-editor.org/rfc/rfc7390</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8368">[RFC8368]</dt>
        <dd>
<span class="refAuthor">Eckert, T., Ed.</span> and <span class="refAuthor">M. Behringer</span>, <span class="refTitle">"Using an Autonomic Control Plane for Stable Connectivity of Network Operations, Administration, and Maintenance (OAM)"</span>, <span class="seriesInfo">RFC 8368</span>, <span class="seriesInfo">DOI 10.17487/RFC8368</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8368">https://www.rfc-editor.org/rfc/rfc8368</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8990">[RFC8990]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Carpenter, B., Ed.</span>, and <span class="refAuthor">B. Liu, Ed.</span>, <span class="refTitle">"GeneRic Autonomic Signaling Protocol (GRASP)"</span>, <span class="seriesInfo">RFC 8990</span>, <span class="seriesInfo">DOI 10.17487/RFC8990</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8990">https://www.rfc-editor.org/rfc/rfc8990</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8994">[RFC8994]</dt>
        <dd>
<span class="refAuthor">Eckert, T., Ed.</span>, <span class="refAuthor">Behringer, M., Ed.</span>, and <span class="refAuthor">S. Bjarnason</span>, <span class="refTitle">"An Autonomic Control Plane (ACP)"</span>, <span class="seriesInfo">RFC 8994</span>, <span class="seriesInfo">DOI 10.17487/RFC8994</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8994">https://www.rfc-editor.org/rfc/rfc8994</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8995">https://www.rfc-editor.org/rfc/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9148">[RFC9148]</dt>
        <dd>
<span class="refAuthor">van der Stok, P.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">Richardson, M.</span>, and <span class="refAuthor">S. Raza</span>, <span class="refTitle">"EST-coaps: Enrollment over Secure Transport with the Secure Constrained Application Protocol"</span>, <span class="seriesInfo">RFC 9148</span>, <span class="seriesInfo">DOI 10.17487/RFC9148</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9148">https://www.rfc-editor.org/rfc/rfc9148</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
      <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9176">https://www.rfc-editor.org/rfc/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.eckert-anima-grasp-dnssd">[I-D.eckert-anima-grasp-dnssd]</dt>
        <dd>
<span class="refAuthor">Eckert, T. T.</span>, <span class="refAuthor">Boucadair, M.</span>, <span class="refAuthor">Jacquenet, C.</span>, and <span class="refAuthor">M. H. Behringer</span>, <span class="refTitle">"DNS-SD Compatible Service Discovery in GeneRic Autonomic Signaling Protocol (GRASP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-eckert-anima-grasp-dnssd-06</span>, <time datetime="2024-01-05" class="refDate">5 January 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-eckert-anima-grasp-dnssd-06">https://datatracker.ietf.org/doc/html/draft-eckert-anima-grasp-dnssd-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5988">[RFC5988]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 5988</span>, <span class="seriesInfo">DOI 10.17487/RFC5988</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5988">https://www.rfc-editor.org/rfc/rfc5988</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8894">[RFC8894]</dt>
      <dd>
<span class="refAuthor">Gutmann, P.</span>, <span class="refTitle">"Simple Certificate Enrolment Protocol"</span>, <span class="seriesInfo">RFC 8894</span>, <span class="seriesInfo">DOI 10.17487/RFC8894</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8894">https://www.rfc-editor.org/rfc/rfc8894</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="discovery-for-constrained-brski">
<section id="appendix-A">
      <h2 id="name-discovery-for-constrained-b">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-discovery-for-constrained-b" class="section-name selfRef">Discovery for constrained BRSKI</a>
      </h2>
<p id="appendix-A-1">This appendix section is intended to describe the current issues with <a href="#cBRSKI" class="auto internal xref">Section 1</a> and <a href="#cPROXY" class="auto internal xref">Section 1</a> as of 08/2023, which
make both drafts incompatible with this document. It will be removed if/when those issues will be fixed.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="current-constrained-text-for-grasp">
<section id="appendix-A.1">
        <h3 id="name-current-constrained-text-fo">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-current-constrained-text-fo" class="section-name selfRef">Current constrained text for GRASP</a>
        </h3>
<p id="appendix-A.1-1">The following is the current encodings from <a href="#cBRSKI" class="auto internal xref">Section 1</a>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-2.1">
            <p id="appendix-A.1-2.1.1">The transport-proto is IPPROTO_UDP<a href="#appendix-A.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.2">
            <p id="appendix-A.1-2.2.1">the objective is AN_join_registrar, identical to <a href="#BRSKI" class="auto internal xref">Section 1</a>.<a href="#appendix-A.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-2.3">
            <p id="appendix-A.1-2.3.1">the objective name is "BRSKI_RJP".<a href="#appendix-A.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.1-3">Here is an example M_FLOOD announcing the Registrar on example port 5685, which is a port number chosen by the Registrar.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<span id="name-cbrski-fig-5-example-of-reg"></span><div id="cbrski-fig5">
<figure id="figure-12">
          <div class="alignLeft art-text artwork" id="appendix-A.1-4.1">
<pre>
[M_FLOOD, 51804231, h'fda379a6f6ee00000200000064000001', 180000,
[["AN_join_registrar", 4, 255, "BRSKI_RJP"],
[O_IPv6_LOCATOR,
h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5685]]]
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-cbrski-fig-5-example-of-reg" class="selfRef">cBRSKI Fig 5: Example of Registrar announcement message</a>
          </figcaption></figure>
</div>
<p id="appendix-A.1-5">Most Registrars will announce both a JPY-stateless and stateful ports, and may also announce an HTTPS/TLS service:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<div id="cbrski-fig6">
<figure id="figure-13">
          <div class="alignLeft art-text artwork" id="appendix-A.1-6.1">
<pre>
[M_FLOOD, 51840231, h'fda379a6f6ee00000200000064000001', 180000,
[["AN_join_registrar", 4, 255, ""],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_TCP, 8443],
 ["AN_join_registrar", 4, 255, "BRSKI_JP"],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5684],
 ["AN_join_registrar", 4, 255, "BRSKI_RJP"],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5685]]]
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a></figcaption></figure>
</div>
<p id="appendix-A.1-7">The following is the current text from <a href="#cPROXY" class="auto internal xref">Section 1</a>.<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-8.1">
            <p id="appendix-A.1-8.1.1">The transport-proto is IPPROTO_UDP<a href="#appendix-A.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-8.2">
            <p id="appendix-A.1-8.2.1">the objective is AN_join_registrar, identical to <a href="#BRSKI" class="auto internal xref">Section 1</a>.<a href="#appendix-A.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.1-8.3">
            <p id="appendix-A.1-8.3.1">the objective name is "BRSKI_RJP".<a href="#appendix-A.1-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-A.1-9">Here is an example M_FLOOD announcing the Registrar on example port 5685, which is a port number chosen by the Registrar.<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<span id="name-example-of-registrar-announ"></span><div id="cproxy-rjp">
<figure id="figure-14">
          <div class="alignLeft art-text artwork" id="appendix-A.1-10.1">
<pre>
   [M_FLOOD, 51804231, h'fda379a6f6ee00000200000064000001', 180000,
   [["AN_join_registrar", 4, 255, "BRSKI_RJP"],
    [O_IPv6_LOCATOR,
     h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5685]]]
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-example-of-registrar-announ" class="selfRef">Example of Registrar announcement message</a>
          </figcaption></figure>
</div>
<p id="appendix-A.1-11">Most Registrars will announce both a JPY-stateless and stateful ports, and may also announce an HTTPS/TLS service:<a href="#appendix-A.1-11" class="pilcrow">¶</a></p>
<span id="name-example-of-registrar-announc"></span><div id="cproxy-rjp-example">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="appendix-A.1-12.1">
<pre>
   [M_FLOOD, 51840231, h'fda379a6f6ee00000200000064000001', 180000,
   [["AN_join_registrar", 4, 255, ""],
    [O_IPv6_LOCATOR,
     h'fda379a6f6ee00000200000064000001', IPPROTO_TCP, 8443],
    ["AN_join_registrar", 4, 255, "BRSKI_JP"],
    [O_IPv6_LOCATOR,
     h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5684],
    ["AN_join_registrar", 4, 255, "BRSKI_RJP"],
    [O_IPv6_LOCATOR,
     h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5685]]]
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-example-of-registrar-announc" class="selfRef">Example of Registrar announcing two services</a>
          </figcaption></figure>
</div>
<div id="issues-and-proposed-change">
<section id="appendix-A.1.1">
          <h4 id="name-issues-and-proposed-change">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-issues-and-proposed-change" class="section-name selfRef">Issues and proposed change</a>
          </h4>
<p id="appendix-A.1.1-1">One goal of this document is to define variations such that proxies can deal with existing
and future variations. This only works for variations for which proxies would need to perform
specific processing other than passing on data between pledge and registrar.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2">Changes in protocol that require specific new behavior of proxies must therefore not be
variations signaled via the objective-value field of GRASP objectives.<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-3">In result, this document recommends the following changes to the encoding for <a href="#cBRSKI" class="auto internal xref">Section 1</a> and <a href="#cPROXY" class="auto internal xref">Section 1</a>.<a href="#appendix-A.1.1-3" class="pilcrow">¶</a></p>
<span id="name-proposed-encoding-of-regist"></span><div id="new-example">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="appendix-A.1.1-4.1">
<pre>
[M_FLOOD, 51840231, h'fda379a6f6ee00000200000064000001', 180000,
[["AN_join_registrar", 4, 255, ""],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_TCP, 8443],
 ["AN_join_registrar", 4, 255, ""],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5684],
 ["AN_join_registrar_rjp", 4, 255, ""],
 [O_IPv6_LOCATOR,
  h'fda379a6f6ee00000200000064000001', IPPROTO_UDP, 5685]]]
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-proposed-encoding-of-regist" class="selfRef">Proposed Encoding of registrar announcements</a>
            </figcaption></figure>
</div>
<p id="appendix-A.1.1-5">In summary:<a href="#appendix-A.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1.1-6.1">
              <p id="appendix-A.1.1-6.1.1">Circuit proxy operation is indicted with objective-name "AN_join_registrar" and IPPROTO_UDP.
The default for AN_join_registrar/UDP is the use of COAPs and CBOR encoded voucher. For this
default, the objective-value is "".<a href="#appendix-A.1.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-A.1.1-6.2">
              <p id="appendix-A.1.1-6.2.1">Stateless JPY proxy operations is indicated with objective-name "AN_join_registrar_rjp" and IPPROTO_UDP.
The default for AN_join_registrar/UDP is the use of COAPs and CBOR encoded voucher. For this
default, the objective-value is "".<a href="#appendix-A.1.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="future">
<section id="appendix-B">
      <h2 id="name-possible-future-variations">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-possible-future-variations" class="section-name selfRef">Possible future variations</a>
      </h2>
<p id="appendix-B-1">The following table <a href="#fig-future-variations" class="auto internal xref">Table 4</a> shows possible future entries for "Variation String" if
there is an interest for such a variation. Thesew would be subject to expert review and could
hence require appropriate additional specification so that interoperability based on that variation string
can be guaranteed.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="fig-future-variations">
<table class="center" id="table-4">
        <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Context</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
            <th class="text-left" rowspan="1" colspan="1">Variation String</th>
            <th class="text-left" rowspan="1" colspan="1">Variations</th>
            <th class="text-left" rowspan="1" colspan="1">Explanations / Notes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">BRSKI</td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">jose</td>
            <td class="text-left" rowspan="1" colspan="1">rrm jose est</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> with voucher according to <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">jose-cmp</td>
            <td class="text-left" rowspan="1" colspan="1">rrm jose cmp</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> with voucher according to <span>[<a href="#I-D.ietf-anima-jws-voucher" class="cite xref">I-D.ietf-anima-jws-voucher</a>]</span> and enrollment according to <span>[<a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="cite xref">I-D.ietf-lamps-lightweight-cmp-profile</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">cose</td>
            <td class="text-left" rowspan="1" colspan="1">rrm cose est</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> with voucher according to <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">cose-cmp</td>
            <td class="text-left" rowspan="1" colspan="1">rrm cose cmp</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> with voucher according to <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span> and enrollment according to <span>[<a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="cite xref">I-D.ietf-lamps-lightweight-cmp-profile</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">prm-cmp</td>
            <td class="text-left" rowspan="1" colspan="1">prm jose cmp</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span> and <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">prm-cose</td>
            <td class="text-left" rowspan="1" colspan="1">prm cose est</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span> and <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1"> </td>
            <td class="text-left" rowspan="1" colspan="1">-</td>
            <td class="text-left" rowspan="1" colspan="1">prm-cose-cmp</td>
            <td class="text-left" rowspan="1" colspan="1">prm cose cmp</td>
            <td class="text-left" rowspan="1" colspan="1">possible variation of <span>[<a href="#I-D.ietf-anima-brski-prm" class="cite xref">I-D.ietf-anima-brski-prm</a>]</span>, <span>[<a href="#I-D.ietf-anima-constrained-voucher" class="cite xref">I-D.ietf-anima-constrained-voucher</a>]</span> and <span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span>
</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="contributors">
<section id="appendix-C">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Werner</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas-werner@siemens.com" class="email">thomas-werner@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steffen Fries</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steffen.fries@siemens.com" class="email">steffen.fries@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hendrik Brockhaus</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hendrik.brockhaus@siemens.com" class="email">hendrik.brockhaus@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Richardson</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+41%2044%20878%209200" class="tel">+41 44 878 9200</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:mcr+ietf@sandelman.org" class="email">mcr+ietf@sandelman.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David von Oheimb</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div dir="auto" class="left"><span class="street-address">Otto-Hahn-Ring 6</span></div>
<div dir="auto" class="left">
<span class="postal-code">81739</span> <span class="locality">Munich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david.von.oheimb@siemens.com" class="email">david.von.oheimb@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com/" class="url">https://www.siemens.com/</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Toerless Eckert (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Futurewei USA</span></div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tte@cs.fau.de" class="email">tte@cs.fau.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Esko Dijk</span></div>
<div dir="auto" class="left"><span class="org">IoTconsultancy.nl</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:esko.dijk@iotconsultancy.nl" class="email">esko.dijk@iotconsultancy.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
